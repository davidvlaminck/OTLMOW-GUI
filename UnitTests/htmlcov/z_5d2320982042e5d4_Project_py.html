<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Coverage for /Users/runner/work/OTLMOW-GUI/OTLMOW-GUI/Domain/project/Project.py: 77%</title>
    <link rel="icon" sizes="32x32" href="favicon_32_cb_58284776.png">
    <link rel="stylesheet" href="style_cb_6b508a39.css" type="text/css">
    <script src="coverage_html_cb_6fb7b396.js" defer></script>
</head>
<body class="pyfile">
<header>
    <div class="content">
        <h1>
            <span class="text">Coverage for </span><b>/Users/runner/work/OTLMOW-GUI/OTLMOW-GUI/Domain/project/Project.py</b>:
            <span class="pc_cov">77%</span>
        </h1>
        <aside id="help_panel_wrapper">
            <input id="help_panel_state" type="checkbox">
            <label for="help_panel_state">
                <img id="keyboard_icon" src="keybd_closed_cb_ce680311.png" alt="Show/hide keyboard shortcuts">
            </label>
            <div id="help_panel">
                <p class="legend">Shortcuts on this page</p>
                <div class="keyhelp">
                    <p>
                        <kbd>r</kbd>
                        <kbd>m</kbd>
                        <kbd>x</kbd>
                        &nbsp; toggle line displays
                    </p>
                    <p>
                        <kbd>j</kbd>
                        <kbd>k</kbd>
                        &nbsp; next/prev highlighted chunk
                    </p>
                    <p>
                        <kbd>0</kbd> &nbsp; (zero) top of page
                    </p>
                    <p>
                        <kbd>1</kbd> &nbsp; (one) first highlighted chunk
                    </p>
                    <p>
                        <kbd>[</kbd>
                        <kbd>]</kbd>
                        &nbsp; prev/next file
                    </p>
                    <p>
                        <kbd>u</kbd> &nbsp; up to the index
                    </p>
                    <p>
                        <kbd>?</kbd> &nbsp; show/hide this help
                    </p>
                </div>
            </div>
        </aside>
        <h2>
            <span class="text">483 statements &nbsp;</span>
            <button type="button" class="run button_toggle_run" value="run" data-shortcut="r" title="Toggle lines run">373<span class="text"> run</span></button>
            <button type="button" class="mis show_mis button_toggle_mis" value="mis" data-shortcut="m" title="Toggle lines missing">110<span class="text"> missing</span></button>
            <button type="button" class="exc show_exc button_toggle_exc" value="exc" data-shortcut="x" title="Toggle lines excluded">0<span class="text"> excluded</span></button>
        </h2>
        <p class="text">
            <a id="prevFileLink" class="nav" href="z_7abde31eedd1c534_Updater_py.html">&#xab; prev</a> &nbsp; &nbsp;
            <a id="indexLink" class="nav" href="index.html">&Hat; index</a> &nbsp; &nbsp;
            <a id="nextFileLink" class="nav" href="z_5d2320982042e5d4_ProjectFile_py.html">&#xbb; next</a>
            &nbsp; &nbsp; &nbsp;
            <a class="nav" href="https://coverage.readthedocs.io/en/7.10.5">coverage.py v7.10.5</a>,
            created at 2025-08-29 09:27 +0000
        </p>
        <aside class="hidden">
            <button type="button" class="button_next_chunk" data-shortcut="j"></button>
            <button type="button" class="button_prev_chunk" data-shortcut="k"></button>
            <button type="button" class="button_top_of_page" data-shortcut="0"></button>
            <button type="button" class="button_first_chunk" data-shortcut="1"></button>
            <button type="button" class="button_prev_file" data-shortcut="["></button>
            <button type="button" class="button_next_file" data-shortcut="]"></button>
            <button type="button" class="button_to_index" data-shortcut="u"></button>
            <button type="button" class="button_show_hide_help" data-shortcut="?"></button>
        </aside>
    </div>
</header>
<main id="source">
    <p class="run"><span class="n"><a id="t1" href="#t1">1</a></span><span class="t"><span class="key">from</span> <span class="nam">__future__</span> <span class="key">import</span> <span class="nam">annotations</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t2" href="#t2">2</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t3" href="#t3">3</a></span><span class="t"><span class="key">import</span> <span class="nam">asyncio</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t4" href="#t4">4</a></span><span class="t"><span class="key">import</span> <span class="nam">datetime</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t5" href="#t5">5</a></span><span class="t"><span class="key">import</span> <span class="nam">json</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t6" href="#t6">6</a></span><span class="t"><span class="key">import</span> <span class="nam">os</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t7" href="#t7">7</a></span><span class="t"><span class="key">import</span> <span class="nam">shutil</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t8" href="#t8">8</a></span><span class="t"><span class="key">import</span> <span class="nam">zipfile</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t9" href="#t9">9</a></span><span class="t"><span class="key">from</span> <span class="nam">collections</span> <span class="key">import</span> <span class="nam">defaultdict</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t10" href="#t10">10</a></span><span class="t"><span class="key">from</span> <span class="nam">pathlib</span> <span class="key">import</span> <span class="nam">Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t11" href="#t11">11</a></span><span class="t"><span class="key">from</span> <span class="nam">typing</span> <span class="key">import</span> <span class="nam">Optional</span><span class="op">,</span> <span class="nam">Union</span><span class="op">,</span> <span class="nam">cast</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t12" href="#t12">12</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t13" href="#t13">13</a></span><span class="t"><span class="key">from</span> <span class="nam">otlmow_model</span><span class="op">.</span><span class="nam">OtlmowModel</span><span class="op">.</span><span class="nam">BaseClasses</span><span class="op">.</span><span class="nam">RelationInteractor</span> <span class="key">import</span> <span class="nam">RelationInteractor</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t14" href="#t14">14</a></span><span class="t"><span class="key">from</span> <span class="nam">otlmow_model</span><span class="op">.</span><span class="nam">OtlmowModel</span><span class="op">.</span><span class="nam">Classes</span><span class="op">.</span><span class="nam">ImplementatieElement</span><span class="op">.</span><span class="nam">AIMObject</span> <span class="key">import</span> <span class="nam">AIMObject</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t15" href="#t15">15</a></span><span class="t"><span class="key">from</span> <span class="nam">otlmow_model</span><span class="op">.</span><span class="nam">OtlmowModel</span><span class="op">.</span><span class="nam">Classes</span><span class="op">.</span><span class="nam">ImplementatieElement</span><span class="op">.</span><span class="nam">RelatieObject</span> <span class="key">import</span> <span class="nam">RelatieObject</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t16" href="#t16">16</a></span><span class="t"><span class="key">from</span> <span class="nam">otlmow_visuals</span><span class="op">.</span><span class="nam">PyVisWrapper</span> <span class="key">import</span> <span class="nam">PyVisWrapper</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t17" href="#t17">17</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t18" href="#t18">18</a></span><span class="t"><span class="key">from</span> <span class="nam">Domain</span> <span class="key">import</span> <span class="nam">global_vars</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t19" href="#t19">19</a></span><span class="t"><span class="key">from</span> <span class="nam">Domain</span><span class="op">.</span><span class="nam">util</span><span class="op">.</span><span class="nam">Helpers</span> <span class="key">import</span> <span class="nam">Helpers</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t20" href="#t20">20</a></span><span class="t"><span class="key">from</span> <span class="nam">Domain</span><span class="op">.</span><span class="nam">database</span><span class="op">.</span><span class="nam">ModelBuilder</span> <span class="key">import</span> <span class="nam">ModelBuilder</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t21" href="#t21">21</a></span><span class="t"><span class="key">from</span> <span class="nam">Domain</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">OTLLogger</span> <span class="key">import</span> <span class="nam">OTLLogger</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t22" href="#t22">22</a></span><span class="t"><span class="key">from</span> <span class="nam">Domain</span><span class="op">.</span><span class="nam">project</span><span class="op">.</span><span class="nam">ProjectFile</span> <span class="key">import</span> <span class="nam">ProjectFile</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t23" href="#t23">23</a></span><span class="t"><span class="key">from</span> <span class="nam">Domain</span><span class="op">.</span><span class="nam">enums</span> <span class="key">import</span> <span class="nam">FileState</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t24" href="#t24">24</a></span><span class="t"><span class="key">from</span> <span class="nam">Domain</span><span class="op">.</span><span class="nam">ProgramFileStructure</span> <span class="key">import</span> <span class="nam">ProgramFileStructure</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t25" href="#t25">25</a></span><span class="t"><span class="key">from</span> <span class="nam">Domain</span><span class="op">.</span><span class="nam">util</span><span class="op">.</span><span class="nam">VisualisationStateTracker</span> <span class="key">import</span> <span class="nam">VisualisationStateTracker</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t26" href="#t26">26</a></span><span class="t"><span class="key">from</span> <span class="nam">Exceptions</span><span class="op">.</span><span class="nam">ExcelFileUnavailableError</span> <span class="key">import</span> <span class="nam">ExcelFileUnavailableError</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t27" href="#t27">27</a></span><span class="t"><span class="key">from</span> <span class="nam">GUI</span><span class="op">.</span><span class="nam">dialog_windows</span><span class="op">.</span><span class="nam">LoadingImageWindow</span> <span class="key">import</span> <span class="nam">add_loading_screen</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t28" href="#t28">28</a></span><span class="t"><span class="key">from</span> <span class="nam">GUI</span><span class="op">.</span><span class="nam">dialog_windows</span><span class="op">.</span><span class="nam">NotificationWindow</span> <span class="key">import</span> <span class="nam">NotificationWindow</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t29" href="#t29">29</a></span><span class="t"><span class="key">from</span> <span class="nam">GUI</span><span class="op">.</span><span class="nam">dialog_windows</span><span class="op">.</span><span class="nam">ProjectExistsError</span> <span class="key">import</span> <span class="nam">ProjectExistsError</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t30" href="#t30">30</a></span><span class="t"><span class="key">from</span> <span class="nam">GUI</span><span class="op">.</span><span class="nam">dialog_windows</span><span class="op">.</span><span class="nam">YesOrNoNotificationWindow</span> <span class="key">import</span> <span class="nam">YesOrNoNotificationWindow</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t31" href="#t31">31</a></span><span class="t"><span class="key">from</span> <span class="nam">GUI</span><span class="op">.</span><span class="nam">translation</span><span class="op">.</span><span class="nam">GlobalTranslate</span> <span class="key">import</span> <span class="nam">GlobalTranslate</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t32" href="#t32">32</a></span><span class="t"><span class="key">from</span> <span class="nam">exception_handler</span><span class="op">.</span><span class="nam">ExceptionHandlers</span> <span class="key">import</span> <span class="nam">create_task_reraise_exception</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t33" href="#t33">33</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t34" href="#t34">34</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t35" href="#t35">35</a></span><span class="t"><span class="key">class</span> <span class="nam">Project</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t36" href="#t36">36</a></span><span class="t">    <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t37" href="#t37">37</a></span><span class="t"><span class="str">    Normal Project Structure:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t38" href="#t38">38</a></span><span class="t"><span class="str">    &#9474;   &lt;self.eigen_referentie>                 : folder</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t39" href="#t39">39</a></span><span class="t"><span class="str">    &#9474;   &#9474;   project_details.json                : json-file</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t40" href="#t40">40</a></span><span class="t"><span class="str">    &#9474;   &#9474;   saved_documents.json                : json-file</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t41" href="#t41">41</a></span><span class="t"><span class="str">    &#9474;   &#9474;   &lt;self.subset_path_name>.db          : sqlite file</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t42" href="#t42">42</a></span><span class="t"><span class="str">    &#9474;   &#9500;&#9472;&#9472;&#9472;project-files                       : folder</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t43" href="#t43">43</a></span><span class="t"><span class="str">    &#9474;   &#9474;       &lt;saved_project_files[0]>.xlsx   : xlsx,json,geojson,csv file</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t44" href="#t44">44</a></span><span class="t"><span class="str">    &#9474;   &#9492;&#9472;&#9472;&#9472;quick_saves                         : folder</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t45" href="#t45">45</a></span><span class="t"><span class="str">    &#9474;           quick_save-&lt;date>_&lt;time>.json   : json-file</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t46" href="#t46">46</a></span><span class="t"><span class="str">    """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t47" href="#t47">47</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t48" href="#t48">48</a></span><span class="t">    <span class="nam">project_details_filename</span> <span class="op">=</span> <span class="str">'project_details.json'</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t49" href="#t49">49</a></span><span class="t">    <span class="nam">saved_documents_filename</span> <span class="op">=</span> <span class="str">"saved_documents.json"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t50" href="#t50">50</a></span><span class="t">    <span class="nam">project_files_foldername</span> <span class="op">=</span> <span class="str">'project_files'</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t51" href="#t51">51</a></span><span class="t">    <span class="nam">old_project_files_foldername</span> <span class="op">=</span> <span class="str">'OTL-template-files'</span> <span class="com"># for legacy compatibility</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t52" href="#t52">52</a></span><span class="t">    <span class="nam">quick_saves_foldername</span> <span class="op">=</span>  <span class="str">"quick_saves"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t53" href="#t53">53</a></span><span class="t">    <span class="nam">visualisation_foldername</span> <span class="op">=</span> <span class="str">"visuals"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t54" href="#t54">54</a></span><span class="t">    <span class="nam">visualisation_filename</span> <span class="op">=</span> <span class="str">"graph_visualisation.html"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t55" href="#t55">55</a></span><span class="t">    <span class="nam">visualisation_python_support_data_filename</span> <span class="op">=</span> <span class="str">"visuals_python_support_data.json"</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t56" href="#t56">56</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t57" href="#t57">57</a></span><span class="t">    <span class="nam">max_days_quicksave_stored</span> <span class="op">=</span> <span class="num">7</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t58" href="#t58">58</a></span><span class="t">    <span class="nam">quicksave_date_format</span> <span class="op">=</span> <span class="str">"%y%m%d_%H%M%S"</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t59" href="#t59">59</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t60" href="#t60">60</a></span><span class="t">    <span class="key">def</span> <span class="nam">__init__</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">eigen_referentie</span><span class="op">:</span> <span class="nam">str</span><span class="op">,</span> <span class="nam">project_path</span><span class="op">:</span> <span class="nam">Path</span> <span class="op">=</span> <span class="key">None</span><span class="op">,</span> <span class="nam">subset_path</span><span class="op">:</span> <span class="nam">Path</span> <span class="op">=</span> <span class="key">None</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t61" href="#t61">61</a></span><span class="t">                 <span class="nam">saved_documents_overview_path</span><span class="op">:</span> <span class="nam">Path</span> <span class="op">=</span> <span class="key">None</span><span class="op">,</span> <span class="nam">bestek</span><span class="op">:</span> <span class="nam">str</span> <span class="op">=</span> <span class="key">None</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t62" href="#t62">62</a></span><span class="t">                 <span class="nam">laatst_bewerkt</span><span class="op">:</span> <span class="nam">datetime</span><span class="op">.</span><span class="nam">datetime</span> <span class="op">=</span> <span class="key">None</span><span class="op">,</span> <span class="nam">last_quick_save</span><span class="op">:</span> <span class="nam">Optional</span><span class="op">[</span><span class="nam">Path</span><span class="op">]</span> <span class="op">=</span> <span class="key">None</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t63" href="#t63">63</a></span><span class="t">                 <span class="nam">subset_operator</span><span class="op">:</span> <span class="nam">Optional</span><span class="op">[</span><span class="nam">Union</span><span class="op">[</span><span class="nam">str</span><span class="op">,</span> <span class="nam">Path</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="key">None</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t64" href="#t64">64</a></span><span class="t">                 <span class="nam">otl_version</span><span class="op">:</span> <span class="nam">Optional</span><span class="op">[</span><span class="nam">Union</span><span class="op">[</span><span class="nam">str</span><span class="op">,</span> <span class="nam">Path</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="key">None</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t65" href="#t65">65</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t66" href="#t66">66</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">:</span> <span class="nam">Path</span> <span class="op">=</span> <span class="nam">project_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t67" href="#t67">67</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t68" href="#t68">68</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t69" href="#t69">69</a></span><span class="t">                <span class="nam">ProgramFileStructure</span><span class="op">.</span><span class="nam">get_otl_wizard_projects_dir</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="nam">eigen_referentie</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t70" href="#t70">70</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t71" href="#t71">71</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">:</span> <span class="nam">Path</span> <span class="op">=</span> <span class="nam">subset_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t72" href="#t72">72</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t73" href="#t73">73</a></span><span class="t">        <span class="key">if</span> <span class="nam">isinstance</span><span class="op">(</span><span class="nam">subset_operator</span><span class="op">,</span><span class="nam">Path</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t74" href="#t74">74</a></span><span class="t">            <span class="nam">subset_operator</span> <span class="op">=</span> <span class="nam">subset_operator</span><span class="op">.</span><span class="nam">stem</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t75" href="#t75">75</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">subset_operator</span><span class="op">:</span> <span class="nam">Optional</span><span class="op">[</span><span class="nam">str</span><span class="op">]</span> <span class="op">=</span> <span class="nam">subset_operator</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t76" href="#t76">76</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t77" href="#t77">77</a></span><span class="t">        <span class="key">if</span> <span class="nam">isinstance</span><span class="op">(</span><span class="nam">otl_version</span><span class="op">,</span><span class="nam">Path</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t78" href="#t78">78</a></span><span class="t">            <span class="nam">otl_version</span> <span class="op">=</span> <span class="nam">otl_version</span><span class="op">.</span><span class="nam">stem</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t79" href="#t79">79</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">otl_version</span><span class="op">:</span> <span class="nam">Optional</span><span class="op">[</span><span class="nam">str</span><span class="op">]</span> <span class="op">=</span> <span class="nam">otl_version</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t80" href="#t80">80</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t81" href="#t81">81</a></span><span class="t">        <span class="key">if</span> <span class="nam">saved_documents_overview_path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t82" href="#t82">82</a></span><span class="t">            <span class="key">if</span> <span class="str">".json"</span> <span class="key">in</span> <span class="nam">str</span><span class="op">(</span><span class="nam">saved_documents_overview_path</span><span class="op">.</span><span class="nam">absolute</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t83" href="#t83">83</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">saved_documents_overview_path</span><span class="op">:</span> <span class="nam">Path</span> <span class="op">=</span> <span class="nam">saved_documents_overview_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t84" href="#t84">84</a></span><span class="t">            <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t85" href="#t85">85</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">saved_documents_overview_path</span><span class="op">:</span> <span class="nam">Path</span> <span class="op">=</span> <span class="nam">saved_documents_overview_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_documents_filename</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t86" href="#t86">86</a></span><span class="t">        <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t87" href="#t87">87</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">saved_documents_overview_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_documents_filename</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t88" href="#t88">88</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t89" href="#t89">89</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">quick_save_dir_path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">quick_saves_foldername</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t90" href="#t90">90</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t91" href="#t91">91</a></span><span class="t">        <span class="key">if</span> <span class="nam">last_quick_save</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t92" href="#t92">92</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">last_quick_save</span><span class="op">:</span><span class="nam">Path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_quicksaves_dir_path</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="nam">last_quick_save</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t93" href="#t93">93</a></span><span class="t">        <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t94" href="#t94">94</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">last_quick_save</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t95" href="#t95">95</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t96" href="#t96">96</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">:</span> <span class="nam">str</span> <span class="op">=</span> <span class="nam">eigen_referentie</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t97" href="#t97">97</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">bestek</span><span class="op">:</span> <span class="nam">str</span> <span class="op">=</span> <span class="nam">bestek</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t98" href="#t98">98</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">laatst_bewerkt</span><span class="op">:</span> <span class="nam">datetime</span><span class="op">.</span><span class="nam">datetime</span> <span class="op">=</span> <span class="nam">laatst_bewerkt</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t99" href="#t99">99</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t100" href="#t100">100</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assets_in_memory</span><span class="op">:</span><span class="nam">list</span><span class="op">[</span><span class="nam">Union</span><span class="op">[</span><span class="nam">RelatieObject</span><span class="op">,</span> <span class="nam">RelationInteractor</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t101" href="#t101">101</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t102" href="#t102">102</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span><span class="op">:</span> <span class="nam">list</span><span class="op">[</span><span class="nam">ProjectFile</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t103" href="#t103">103</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">model_builder</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t104" href="#t104">104</a></span><span class="t">        <span class="com">#status tracking if the visualisation is uptodate with changes in relations and OTL-assets</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t105" href="#t105">105</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">visualisation_uptodate</span><span class="op">:</span> <span class="nam">VisualisationStateTracker</span> <span class="op">=</span> <span class="nam">VisualisationStateTracker</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t106" href="#t106">106</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">graph_saved_status</span><span class="op">:</span> <span class="nam">bool</span> <span class="op">=</span> <span class="key">True</span> <span class="com"># status tracking if graph changes are written to html</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t107" href="#t107">107</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t108" href="#t108">108</a></span><span class="t">    <span class="op">@</span><span class="nam">classmethod</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t109" href="#t109">109</a></span><span class="t">    <span class="key">def</span> <span class="nam">load_project</span><span class="op">(</span><span class="nam">cls</span><span class="op">,</span> <span class="nam">project_path</span><span class="op">:</span> <span class="nam">Path</span> <span class="op">=</span> <span class="key">None</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t110" href="#t110">110</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t111" href="#t111">111</a></span><span class="t"><span class="str">        Loads a project from a specified directory by reading its details from a JSON file.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t112" href="#t112">112</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t113" href="#t113">113</a></span><span class="t"><span class="str">        It validates the existence of the project directory and the required project details file</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t114" href="#t114">114</a></span><span class="t"><span class="str">        before extracting and returning the project information.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t115" href="#t115">115</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t116" href="#t116">116</a></span><span class="t"><span class="str">        :param project_path: The path to the project directory. Defaults to None.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t117" href="#t117">117</a></span><span class="t"><span class="str">        :type project_path: Path, optional</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t118" href="#t118">118</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t119" href="#t119">119</a></span><span class="t"><span class="str">        :return: An instance of the project class initialized with the loaded details.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t120" href="#t120">120</a></span><span class="t"><span class="str">        :rtype: Project</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t121" href="#t121">121</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t122" href="#t122">122</a></span><span class="t"><span class="str">        :raises FileNotFoundError:  If the project directory or the project details file does not</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t123" href="#t123">123</a></span><span class="t"><span class="str">                                    exist.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t124" href="#t124">124</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t125" href="#t125">125</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">info</span><span class="op">(</span><span class="fst">f"</span><span class="fst">loading project details: </span><span class="op">{</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">"</span><span class="op">,</span><span class="nam">extra</span><span class="op">=</span><span class="op">{</span><span class="str">"timing_ref"</span><span class="op">:</span><span class="fst">f"</span><span class="fst">details_</span><span class="op">{</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">"</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t126" href="#t126">126</a></span><span class="t">        <span class="key">if</span> <span class="nam">project_path</span> <span class="key">and</span> <span class="key">not</span> <span class="nam">project_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t127" href="#t127">127</a></span><span class="t">            <span class="key">raise</span> <span class="nam">FileNotFoundError</span><span class="op">(</span><span class="fst">f"</span><span class="fst">Project dir </span><span class="op">{</span><span class="nam">project_path</span><span class="op">}</span><span class="fst"> does not exist</span><span class="fst">"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t128" href="#t128">128</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t129" href="#t129">129</a></span><span class="t">        <span class="nam">project_details_file</span> <span class="op">=</span> <span class="nam">project_path</span> <span class="op">/</span> <span class="nam">cls</span><span class="op">.</span><span class="nam">project_details_filename</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t130" href="#t130">130</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">project_details_file</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t131" href="#t131">131</a></span><span class="t">            <span class="key">raise</span> <span class="nam">FileNotFoundError</span><span class="op">(</span><span class="fst">f"</span><span class="fst">Project details file </span><span class="op">{</span><span class="nam">project_details_file</span><span class="op">}</span><span class="fst"> does not exist</span><span class="fst">"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t132" href="#t132">132</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t133" href="#t133">133</a></span><span class="t">        <span class="key">with</span> <span class="nam">open</span><span class="op">(</span><span class="nam">project_details_file</span><span class="op">)</span> <span class="key">as</span> <span class="nam">json_file</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t134" href="#t134">134</a></span><span class="t">            <span class="nam">project_details</span> <span class="op">=</span> <span class="nam">json</span><span class="op">.</span><span class="nam">load</span><span class="op">(</span><span class="nam">json_file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t135" href="#t135">135</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t136" href="#t136">136</a></span><span class="t">        <span class="key">if</span> <span class="str">'last_quick_save'</span> <span class="key">not</span> <span class="key">in</span> <span class="nam">project_details</span> <span class="key">or</span> <span class="key">not</span> <span class="nam">project_details</span><span class="op">[</span><span class="str">'last_quick_save'</span><span class="op">]</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t137" href="#t137">137</a></span><span class="t">            <span class="nam">last_quick_save</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t138" href="#t138">138</a></span><span class="t">        <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t139" href="#t139">139</a></span><span class="t">            <span class="nam">last_quick_save</span> <span class="op">=</span> <span class="op">(</span><span class="nam">Path</span><span class="op">(</span><span class="nam">project_path</span> <span class="op">/</span> <span class="nam">cls</span><span class="op">.</span><span class="nam">quick_saves_foldername</span><span class="op">)</span> <span class="op">/</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t140" href="#t140">140</a></span><span class="t">                               <span class="nam">Path</span><span class="op">(</span><span class="nam">project_details</span><span class="op">[</span><span class="str">'last_quick_save'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t141" href="#t141">141</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t142" href="#t142">142</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t143" href="#t143">143</a></span><span class="t">        <span class="key">if</span> <span class="str">'subset_operator'</span> <span class="key">not</span> <span class="key">in</span> <span class="nam">project_details</span> <span class="key">or</span> <span class="key">not</span> <span class="nam">project_details</span><span class="op">[</span><span class="str">'subset_operator'</span><span class="op">]</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t144" href="#t144">144</a></span><span class="t">            <span class="nam">subset_operator</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t145" href="#t145">145</a></span><span class="t">        <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t146" href="#t146">146</a></span><span class="t">            <span class="nam">subset_operator</span> <span class="op">=</span> <span class="nam">project_details</span><span class="op">[</span><span class="str">'subset_operator'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t147" href="#t147">147</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t148" href="#t148">148</a></span><span class="t">        <span class="key">if</span> <span class="str">'otl_version'</span> <span class="key">not</span> <span class="key">in</span> <span class="nam">project_details</span> <span class="key">or</span> <span class="key">not</span> <span class="nam">project_details</span><span class="op">[</span><span class="str">'otl_version'</span><span class="op">]</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t149" href="#t149">149</a></span><span class="t">            <span class="nam">otl_version</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t150" href="#t150">150</a></span><span class="t">        <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t151" href="#t151">151</a></span><span class="t">            <span class="nam">otl_version</span> <span class="op">=</span> <span class="nam">project_details</span><span class="op">[</span><span class="str">'otl_version'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t152" href="#t152">152</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t153" href="#t153">153</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">info</span><span class="op">(</span><span class="fst">f"</span><span class="fst">loading project details: </span><span class="op">{</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t154" href="#t154">154</a></span><span class="t">                              <span class="op">,</span><span class="nam">extra</span><span class="op">=</span><span class="op">{</span><span class="str">"timing_ref"</span><span class="op">:</span><span class="fst">f"</span><span class="fst">details_</span><span class="op">{</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">"</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t155" href="#t155">155</a></span><span class="t">        <span class="key">return</span> <span class="nam">cls</span><span class="op">(</span><span class="nam">project_path</span><span class="op">=</span><span class="nam">project_path</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t156" href="#t156">156</a></span><span class="t">                   <span class="nam">subset_path</span><span class="op">=</span><span class="nam">project_path</span> <span class="op">/</span> <span class="nam">project_details</span><span class="op">[</span><span class="str">'subset'</span><span class="op">]</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t157" href="#t157">157</a></span><span class="t">                   <span class="nam">saved_documents_overview_path</span><span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">project_path</span><span class="op">,</span>  <span class="nam">cls</span><span class="op">.</span><span class="nam">saved_documents_filename</span><span class="op">)</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t158" href="#t158">158</a></span><span class="t">                   <span class="nam">eigen_referentie</span><span class="op">=</span><span class="nam">project_details</span><span class="op">[</span><span class="str">'eigen_referentie'</span><span class="op">]</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t159" href="#t159">159</a></span><span class="t">                   <span class="nam">bestek</span><span class="op">=</span><span class="nam">project_details</span><span class="op">[</span><span class="str">'bestek'</span><span class="op">]</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t160" href="#t160">160</a></span><span class="t">                   <span class="nam">laatst_bewerkt</span><span class="op">=</span><span class="nam">datetime</span><span class="op">.</span><span class="nam">datetime</span><span class="op">.</span><span class="nam">strptime</span><span class="op">(</span><span class="nam">project_details</span><span class="op">[</span><span class="str">'laatst_bewerkt'</span><span class="op">]</span><span class="op">,</span> <span class="str">"%Y-%m-%d %H:%M:%S"</span><span class="op">)</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t161" href="#t161">161</a></span><span class="t">                   <span class="nam">last_quick_save</span><span class="op">=</span><span class="nam">last_quick_save</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t162" href="#t162">162</a></span><span class="t">                   <span class="nam">subset_operator</span><span class="op">=</span><span class="nam">subset_operator</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t163" href="#t163">163</a></span><span class="t">                   <span class="nam">otl_version</span><span class="op">=</span><span class="nam">otl_version</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t164" href="#t164">164</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t165" href="#t165">165</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t166" href="#t166">166</a></span><span class="t">    <span class="key">def</span> <span class="nam">save_project_to_dir</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t167" href="#t167">167</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t168" href="#t168">168</a></span><span class="t"><span class="str">        Saves the current project to a designated directory, including project details and any</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t169" href="#t169">169</a></span><span class="t"><span class="str">        associated subset files.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t170" href="#t170">170</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t171" href="#t171">171</a></span><span class="t"><span class="str">        This function ensures that the project directory is created if it does not exist and</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t172" href="#t172">172</a></span><span class="t"><span class="str">        updates the last modified timestamp if necessary.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t173" href="#t173">173</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t174" href="#t174">174</a></span><span class="t"><span class="str">        :param self: The instance of the class containing project details.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t175" href="#t175">175</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t176" href="#t176">176</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t177" href="#t177">177</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t178" href="#t178">178</a></span><span class="t"><span class="str">        :raises OSError:    If there is an error creating the directory or writing the project</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t179" href="#t179">179</a></span><span class="t"><span class="str">                            details file.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t180" href="#t180">180</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t181" href="#t181">181</a></span><span class="t"><span class="str">        :example:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t182" href="#t182">182</a></span><span class="t"><span class="str">            project.save_project_to_dir()</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t183" href="#t183">183</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t184" href="#t184">184</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t185" href="#t185">185</a></span><span class="t">        <span class="nam">project_dir_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_project_local_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t186" href="#t186">186</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t187" href="#t187">187</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="str">"Saving project to %s"</span><span class="op">,</span> <span class="nam">project_dir_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t188" href="#t188">188</a></span><span class="t">        <span class="nam">project_dir_path</span><span class="op">.</span><span class="nam">mkdir</span><span class="op">(</span><span class="nam">exist_ok</span><span class="op">=</span><span class="key">True</span><span class="op">,</span> <span class="nam">parents</span><span class="op">=</span><span class="key">True</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t189" href="#t189">189</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">save_project_details</span><span class="op">(</span><span class="nam">project_dir_path</span><span class="op">=</span><span class="nam">project_dir_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t190" href="#t190">190</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t191" href="#t191">191</a></span><span class="t">        <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span> <span class="key">and</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">.</span><span class="nam">parent</span><span class="op">.</span><span class="nam">absolute</span><span class="op">(</span><span class="op">)</span> <span class="op">!=</span> <span class="nam">project_dir_path</span><span class="op">.</span><span class="nam">absolute</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t192" href="#t192">192</a></span><span class="t">            <span class="com"># move subset to project dir</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t193" href="#t193">193</a></span><span class="t">            <span class="nam">new_subset_path</span> <span class="op">=</span> <span class="nam">project_dir_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t194" href="#t194">194</a></span><span class="t">            <span class="nam">shutil</span><span class="op">.</span><span class="nam">copy</span><span class="op">(</span><span class="nam">src</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">,</span> <span class="nam">dst</span><span class="op">=</span><span class="nam">new_subset_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t195" href="#t195">195</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t196" href="#t196">196</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_project_local_path</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">Path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t197" href="#t197">197</a></span><span class="t">        <span class="nam">otl_wizard_project_dir</span> <span class="op">=</span> <span class="nam">ProgramFileStructure</span><span class="op">.</span><span class="nam">get_otl_wizard_projects_dir</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t198" href="#t198">198</a></span><span class="t">        <span class="key">return</span> <span class="nam">otl_wizard_project_dir</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t199" href="#t199">199</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t200" href="#t200">200</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_current_visuals_folder_path</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">Path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t201" href="#t201">201</a></span><span class="t">        <span class="nam">visuals_folder</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_project_local_path</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">visualisation_foldername</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t202" href="#t202">202</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t203" href="#t203">203</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">visuals_folder</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t204" href="#t204">204</a></span><span class="t">            <span class="nam">os</span><span class="op">.</span><span class="nam">makedirs</span><span class="op">(</span><span class="nam">visuals_folder</span><span class="op">,</span> <span class="nam">exist_ok</span><span class="op">=</span><span class="key">True</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t205" href="#t205">205</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t206" href="#t206">206</a></span><span class="t">        <span class="key">return</span> <span class="nam">visuals_folder</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t207" href="#t207">207</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t208" href="#t208">208</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_current_visuals_html_path</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">Path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t209" href="#t209">209</a></span><span class="t">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_current_visuals_folder_path</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">visualisation_filename</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t210" href="#t210">210</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t211" href="#t211">211</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_visualisation_python_support_data_path</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">Path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t212" href="#t212">212</a></span><span class="t">        <span class="nam">visuals_uptodate_state_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_current_visuals_folder_path</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">visualisation_python_support_data_filename</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t213" href="#t213">213</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t214" href="#t214">214</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">visuals_uptodate_state_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t215" href="#t215">215</a></span><span class="t">            <span class="key">with</span> <span class="nam">open</span><span class="op">(</span><span class="nam">visuals_uptodate_state_path</span><span class="op">,</span><span class="str">"w"</span><span class="op">)</span> <span class="key">as</span> <span class="nam">file</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t216" href="#t216">216</a></span><span class="t">                <span class="nam">json</span><span class="op">.</span><span class="nam">dump</span><span class="op">(</span><span class="op">{</span><span class="str">"visuals_uptodate"</span><span class="op">:</span><span class="key">False</span><span class="op">}</span><span class="op">,</span><span class="nam">file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t217" href="#t217">217</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t218" href="#t218">218</a></span><span class="t">        <span class="key">return</span> <span class="nam">visuals_uptodate_state_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t219" href="#t219">219</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t220" href="#t220">220</a></span><span class="t">    <span class="key">def</span> <span class="nam">load_visualisation_python_support_data</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span><span class="nam">vis_wrap</span><span class="op">:</span> <span class="nam">Optional</span><span class="op">[</span><span class="nam">PyVisWrapper</span><span class="op">]</span> <span class="op">=</span> <span class="key">None</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t221" href="#t221">221</a></span><span class="t">        <span class="nam">file_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_visualisation_python_support_data_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t222" href="#t222">222</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t223" href="#t223">223</a></span><span class="t">        <span class="key">with</span> <span class="nam">open</span><span class="op">(</span><span class="nam">file_path</span><span class="op">,</span> <span class="str">"r"</span><span class="op">)</span> <span class="key">as</span> <span class="nam">file</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t224" href="#t224">224</a></span><span class="t">            <span class="nam">json_data</span> <span class="op">=</span> <span class="nam">json</span><span class="op">.</span><span class="nam">load</span><span class="op">(</span><span class="nam">file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t225" href="#t225">225</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t226" href="#t226">226</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">visualisation_uptodate</span><span class="op">.</span><span class="nam">set_clear_all</span><span class="op">(</span><span class="key">not</span> <span class="nam">json_data</span><span class="op">[</span><span class="str">"visuals_uptodate"</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t227" href="#t227">227</a></span><span class="t">            <span class="key">if</span> <span class="nam">vis_wrap</span> <span class="key">and</span> <span class="str">"collection_support_data"</span> <span class="key">in</span> <span class="nam">json_data</span><span class="op">.</span><span class="nam">keys</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t228" href="#t228">228</a></span><span class="t">                <span class="nam">vis_wrap</span><span class="op">.</span><span class="nam">special_edges</span> <span class="op">=</span> <span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span><span class="op">[</span><span class="str">"vis_wrap.special_edges"</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t229" href="#t229">229</a></span><span class="t">                <span class="nam">vis_wrap</span><span class="op">.</span><span class="nam">asset_id_to_display_name_dict</span> <span class="op">=</span> <span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span><span class="op">[</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t230" href="#t230">230</a></span><span class="t">                    <span class="str">"vis_wrap.asset_id_to_display_name_dict"</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t231" href="#t231">231</a></span><span class="t">                <span class="nam">vis_wrap</span><span class="op">.</span><span class="nam">relation_id_to_collection_id</span> <span class="op">=</span> <span class="nam">defaultdict</span><span class="op">(</span><span class="nam">list</span><span class="op">,</span><span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span><span class="op">[</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t232" href="#t232">232</a></span><span class="t">                    <span class="str">"vis_wrap.relation_id_to_collection_id"</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t233" href="#t233">233</a></span><span class="t">                <span class="nam">vis_wrap</span><span class="op">.</span><span class="nam">collection_id_to_list_of_relation_ids</span> <span class="op">=</span> <span class="nam">defaultdict</span><span class="op">(</span><span class="nam">list</span><span class="op">,</span><span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span><span class="op">[</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t234" href="#t234">234</a></span><span class="t">                    <span class="str">"vis_wrap.collection_id_to_list_of_relation_ids"</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t235" href="#t235">235</a></span><span class="t">                <span class="nam">vis_wrap</span><span class="op">.</span><span class="nam">collection_relation_count_threshold</span> <span class="op">=</span> <span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span><span class="op">[</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t236" href="#t236">236</a></span><span class="t">                    <span class="str">"vis_wrap.collection_relation_count_threshold"</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t237" href="#t237">237</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t238" href="#t238">238</a></span><span class="t">    <span class="key">def</span> <span class="nam">save_visualisation_python_support_data</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span><span class="nam">vis_wrap</span><span class="op">:</span> <span class="nam">Optional</span><span class="op">[</span><span class="nam">PyVisWrapper</span><span class="op">]</span> <span class="op">=</span> <span class="key">None</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t239" href="#t239">239</a></span><span class="t">        <span class="nam">file_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_visualisation_python_support_data_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t240" href="#t240">240</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t241" href="#t241">241</a></span><span class="t">        <span class="key">if</span> <span class="nam">file_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t242" href="#t242">242</a></span><span class="t">            <span class="com"># load file first to preserve previously saved data</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t243" href="#t243">243</a></span><span class="t">            <span class="key">with</span> <span class="nam">open</span><span class="op">(</span><span class="nam">file_path</span><span class="op">,</span> <span class="str">"r"</span><span class="op">)</span> <span class="key">as</span> <span class="nam">file</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t244" href="#t244">244</a></span><span class="t">                <span class="nam">json_data</span> <span class="op">=</span> <span class="nam">json</span><span class="op">.</span><span class="nam">load</span><span class="op">(</span><span class="nam">file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t245" href="#t245">245</a></span><span class="t">        <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t246" href="#t246">246</a></span><span class="t">            <span class="nam">json_data</span> <span class="op">=</span> <span class="op">{</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t247" href="#t247">247</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t248" href="#t248">248</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t249" href="#t249">249</a></span><span class="t">        <span class="nam">json_data</span><span class="op">[</span><span class="str">"visuals_uptodate"</span><span class="op">]</span> <span class="op">=</span> <span class="key">not</span> <span class="nam">self</span><span class="op">.</span><span class="nam">visualisation_uptodate</span><span class="op">.</span><span class="nam">get_clear_all</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t250" href="#t250">250</a></span><span class="t">        <span class="key">if</span> <span class="nam">vis_wrap</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t251" href="#t251">251</a></span><span class="t">            <span class="key">if</span> <span class="str">"collection_support_data"</span> <span class="key">not</span> <span class="key">in</span> <span class="nam">json_data</span><span class="op">.</span><span class="nam">keys</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t252" href="#t252">252</a></span><span class="t">                <span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t253" href="#t253">253</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t254" href="#t254">254</a></span><span class="t">            <span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span><span class="op">[</span><span class="str">"vis_wrap.special_edges"</span><span class="op">]</span> <span class="op">=</span> <span class="nam">vis_wrap</span><span class="op">.</span><span class="nam">special_edges</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t255" href="#t255">255</a></span><span class="t">            <span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span><span class="op">[</span><span class="str">"vis_wrap.asset_id_to_display_name_dict"</span><span class="op">]</span> <span class="op">=</span> <span class="nam">vis_wrap</span><span class="op">.</span><span class="nam">asset_id_to_display_name_dict</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t256" href="#t256">256</a></span><span class="t">            <span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span><span class="op">[</span><span class="str">"vis_wrap.relation_id_to_collection_id"</span><span class="op">]</span> <span class="op">=</span> <span class="nam">vis_wrap</span><span class="op">.</span><span class="nam">relation_id_to_collection_id</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t257" href="#t257">257</a></span><span class="t">            <span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span><span class="op">[</span><span class="str">"vis_wrap.collection_id_to_list_of_relation_ids"</span><span class="op">]</span> <span class="op">=</span> <span class="nam">vis_wrap</span><span class="op">.</span><span class="nam">collection_id_to_list_of_relation_ids</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t258" href="#t258">258</a></span><span class="t">            <span class="nam">json_data</span><span class="op">[</span><span class="str">"collection_support_data"</span><span class="op">]</span><span class="op">[</span><span class="str">"vis_wrap.collection_relation_count_threshold"</span><span class="op">]</span> <span class="op">=</span> <span class="nam">vis_wrap</span><span class="op">.</span><span class="nam">collection_relation_count_threshold</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t259" href="#t259">259</a></span><span class="t">            <span class="com"># json_data["visualisation_option"] =</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t260" href="#t260">260</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t261" href="#t261">261</a></span><span class="t">        <span class="key">with</span> <span class="nam">open</span><span class="op">(</span><span class="nam">file_path</span><span class="op">,</span> <span class="str">"w"</span><span class="op">)</span> <span class="key">as</span> <span class="nam">file</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t262" href="#t262">262</a></span><span class="t">            <span class="nam">json</span><span class="op">.</span><span class="nam">dump</span><span class="op">(</span><span class="nam">json_data</span> <span class="op">,</span><span class="nam">file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t263" href="#t263">263</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t264" href="#t264">264</a></span><span class="t">    <span class="key">def</span> <span class="nam">save_project_details</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">project_dir_path</span><span class="op">:</span> <span class="nam">Path</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t265" href="#t265">265</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t266" href="#t266">266</a></span><span class="t"><span class="str">        Saves the project's details to a specified directory in JSON format.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t267" href="#t267">267</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t268" href="#t268">268</a></span><span class="t"><span class="str">        This function constructs a dictionary of project attributes and writes it to a file, updating the last modified timestamp if necessary.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t269" href="#t269">269</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t270" href="#t270">270</a></span><span class="t"><span class="str">        :param self: The instance of the class managing the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t271" href="#t271">271</a></span><span class="t"><span class="str">        :param project_dir_path: The directory path where the project details will be saved.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t272" href="#t272">272</a></span><span class="t"><span class="str">        :type project_dir_path: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t273" href="#t273">273</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t274" href="#t274">274</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t275" href="#t275">275</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t276" href="#t276">276</a></span><span class="t"><span class="str">        :raises OSError: If there is an error writing the project details file.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t277" href="#t277">277</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t278" href="#t278">278</a></span><span class="t"><span class="str">        :example:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t279" href="#t279">279</a></span><span class="t"><span class="str">            project.save_project_details(Path('/path/to/project'))</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t280" href="#t280">280</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t281" href="#t281">281</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t282" href="#t282">282</a></span><span class="t">        <span class="nam">last_quick_save_name</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t283" href="#t283">283</a></span><span class="t">        <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">last_quick_save</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t284" href="#t284">284</a></span><span class="t">            <span class="nam">last_quick_save_name</span> <span class="op">=</span> <span class="nam">str</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">last_quick_save</span><span class="op">.</span><span class="nam">name</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t285" href="#t285">285</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t286" href="#t286">286</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">self</span><span class="op">.</span><span class="nam">laatst_bewerkt</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t287" href="#t287">287</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">laatst_bewerkt</span> <span class="op">=</span> <span class="nam">datetime</span><span class="op">.</span><span class="nam">datetime</span><span class="op">.</span><span class="nam">now</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t288" href="#t288">288</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t289" href="#t289">289</a></span><span class="t">        <span class="nam">subset_name</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t290" href="#t290">290</a></span><span class="t">        <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t291" href="#t291">291</a></span><span class="t">            <span class="nam">subset_name</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t292" href="#t292">292</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t293" href="#t293">293</a></span><span class="t">        <span class="nam">project_details_dict</span> <span class="op">=</span> <span class="op">{</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t294" href="#t294">294</a></span><span class="t">            <span class="str">'bestek'</span><span class="op">:</span> <span class="nam">self</span><span class="op">.</span><span class="nam">bestek</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t295" href="#t295">295</a></span><span class="t">            <span class="str">'eigen_referentie'</span><span class="op">:</span> <span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t296" href="#t296">296</a></span><span class="t">            <span class="str">'laatst_bewerkt'</span><span class="op">:</span> <span class="nam">self</span><span class="op">.</span><span class="nam">laatst_bewerkt</span><span class="op">.</span><span class="nam">strftime</span><span class="op">(</span><span class="str">"%Y-%m-%d %H:%M:%S"</span><span class="op">)</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t297" href="#t297">297</a></span><span class="t">            <span class="str">'subset'</span><span class="op">:</span> <span class="nam">subset_name</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t298" href="#t298">298</a></span><span class="t">            <span class="str">'subset_operator'</span><span class="op">:</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_operator_name</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t299" href="#t299">299</a></span><span class="t">            <span class="str">'otl_version'</span><span class="op">:</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_otl_version</span><span class="op">(</span><span class="op">)</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t300" href="#t300">300</a></span><span class="t">            <span class="str">'last_quick_save'</span><span class="op">:</span> <span class="nam">last_quick_save_name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t301" href="#t301">301</a></span><span class="t">        <span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t302" href="#t302">302</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t303" href="#t303">303</a></span><span class="t">        <span class="key">with</span> <span class="nam">open</span><span class="op">(</span><span class="nam">project_dir_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_details_filename</span><span class="op">,</span> <span class="str">"w"</span><span class="op">)</span> <span class="key">as</span> <span class="nam">project_details_file</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t304" href="#t304">304</a></span><span class="t">            <span class="nam">json</span><span class="op">.</span><span class="nam">dump</span><span class="op">(</span><span class="nam">project_details_dict</span><span class="op">,</span> <span class="nam">project_details_file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t305" href="#t305">305</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t306" href="#t306">306</a></span><span class="t">    <span class="op">@</span><span class="nam">add_loading_screen</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t307" href="#t307">307</a></span><span class="t">    <span class="key">async</span> <span class="key">def</span> <span class="nam">load_validated_assets_async</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">list</span><span class="op">[</span><span class="nam">Union</span><span class="op">[</span><span class="nam">RelatieObject</span><span class="op">,</span> <span class="nam">RelationInteractor</span><span class="op">]</span><span class="op">]</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t308" href="#t308">308</a></span><span class="t">        <span class="com"># sourcery skip: assign-if-exp, reintroduce-else, use-named-expression</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t309" href="#t309">309</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t310" href="#t310">310</a></span><span class="t"><span class="str">        Loads validated assets from the most recent quick save file.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t311" href="#t311">311</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t312" href="#t312">312</a></span><span class="t"><span class="str">        If a valid quick save path is found, it converts the file contents into a list of AIMObject</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t313" href="#t313">313</a></span><span class="t"><span class="str">        instances; otherwise, it returns an empty list.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t314" href="#t314">314</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t315" href="#t315">315</a></span><span class="t"><span class="str">        :param self: The instance of the class managing asset loading.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t316" href="#t316">316</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t317" href="#t317">317</a></span><span class="t"><span class="str">        :return:    A list of validated AIMObject instances loaded from the quick save file, or an</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t318" href="#t318">318</a></span><span class="t"><span class="str">                    empty list if no valid path is found.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t319" href="#t319">319</a></span><span class="t"><span class="str">        :rtype: list[AIMObject]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t320" href="#t320">320</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t321" href="#t321">321</a></span><span class="t"><span class="str">        :example:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t322" href="#t322">322</a></span><span class="t"><span class="str">            assets = project.load_validated_assets()</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t323" href="#t323">323</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t324" href="#t324">324</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t325" href="#t325">325</a></span><span class="t">        <span class="nam">path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_last_quick_save_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t326" href="#t326">326</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t327" href="#t327">327</a></span><span class="t">        <span class="key">if</span> <span class="nam">path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t328" href="#t328">328</a></span><span class="t">            <span class="nam">timing_ref</span> <span class="op">=</span> <span class="fst">f"</span><span class="fst">load_assets_</span><span class="op">{</span><span class="nam">path</span><span class="op">.</span><span class="nam">stem</span><span class="op">}</span><span class="fst">"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t329" href="#t329">329</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t330" href="#t330">330</a></span><span class="t">                <span class="fst">f"</span><span class="fst">Execute Project.load_validated_assets(</span><span class="op">{</span><span class="nam">path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">) for project </span><span class="fst">"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t331" href="#t331">331</a></span><span class="t">                <span class="fst">f"</span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">}</span><span class="fst">"</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t332" href="#t332">332</a></span><span class="t">                <span class="nam">extra</span><span class="op">=</span><span class="op">{</span><span class="str">"timing_ref"</span><span class="op">:</span> <span class="nam">timing_ref</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t333" href="#t333">333</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t334" href="#t334">334</a></span><span class="t">            <span class="com"># noinspection PyTypeChecker</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t335" href="#t335">335</a></span><span class="t">            <span class="nam">saved_objects</span><span class="op">,</span> <span class="nam">exceptions_group</span> <span class="op">=</span> <span class="key">await</span> <span class="nam">Helpers</span><span class="op">.</span><span class="nam">converter_from_file_to_object_async</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t336" href="#t336">336</a></span><span class="t">                <span class="nam">path</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t337" href="#t337">337</a></span><span class="t">                <span class="nam">allow_non_otl_conform_attributes</span><span class="op">=</span><span class="key">True</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t338" href="#t338">338</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t339" href="#t339">339</a></span><span class="t">            <span class="nam">object_count</span> <span class="op">=</span> <span class="nam">len</span><span class="op">(</span><span class="nam">saved_objects</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t340" href="#t340">340</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t341" href="#t341">341</a></span><span class="t">                <span class="fst">f"</span><span class="fst">Execute Project.load_validated_assets(</span><span class="op">{</span><span class="nam">path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">) for project</span><span class="fst">"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t342" href="#t342">342</a></span><span class="t">                <span class="fst">f"</span><span class="fst"> </span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">}</span><span class="fst"> (</span><span class="op">{</span><span class="nam">object_count</span><span class="op">}</span><span class="fst"> objects)</span><span class="fst">"</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t343" href="#t343">343</a></span><span class="t">                <span class="nam">extra</span><span class="op">=</span><span class="op">{</span><span class="str">"timing_ref"</span><span class="op">:</span>  <span class="nam">timing_ref</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t344" href="#t344">344</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t345" href="#t345">345</a></span><span class="t">            <span class="key">return</span> <span class="nam">saved_objects</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t346" href="#t346">346</a></span><span class="t">        <span class="key">return</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t347" href="#t347">347</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t348" href="#t348">348</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t349" href="#t349">349</a></span><span class="t">    <span class="key">def</span> <span class="nam">load_validated_assets</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">list</span><span class="op">[</span><span class="nam">Union</span><span class="op">[</span><span class="nam">RelatieObject</span><span class="op">,</span> <span class="nam">RelationInteractor</span><span class="op">]</span><span class="op">]</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t350" href="#t350">350</a></span><span class="t">        <span class="com"># sourcery skip: assign-if-exp, reintroduce-else, use-named-expression</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t351" href="#t351">351</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t352" href="#t352">352</a></span><span class="t"><span class="str">        Loads validated assets from the most recent quick save file.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t353" href="#t353">353</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t354" href="#t354">354</a></span><span class="t"><span class="str">        If a valid quick save path is found, it converts the file contents into a list of AIMObject</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t355" href="#t355">355</a></span><span class="t"><span class="str">        instances; otherwise, it returns an empty list.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t356" href="#t356">356</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t357" href="#t357">357</a></span><span class="t"><span class="str">        :param self: The instance of the class managing asset loading.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t358" href="#t358">358</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t359" href="#t359">359</a></span><span class="t"><span class="str">        :return:    A list of validated AIMObject instances loaded from the quick save file, or an</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t360" href="#t360">360</a></span><span class="t"><span class="str">                    empty list if no valid path is found.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t361" href="#t361">361</a></span><span class="t"><span class="str">        :rtype: list[AIMObject]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t362" href="#t362">362</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t363" href="#t363">363</a></span><span class="t"><span class="str">        :example:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t364" href="#t364">364</a></span><span class="t"><span class="str">            assets = project.load_validated_assets()</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t365" href="#t365">365</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t366" href="#t366">366</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t367" href="#t367">367</a></span><span class="t">        <span class="nam">path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_last_quick_save_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t368" href="#t368">368</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t369" href="#t369">369</a></span><span class="t">        <span class="key">if</span> <span class="nam">path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t370" href="#t370">370</a></span><span class="t">            <span class="nam">timing_ref</span> <span class="op">=</span> <span class="fst">f"</span><span class="fst">load_assets_</span><span class="op">{</span><span class="nam">path</span><span class="op">.</span><span class="nam">stem</span><span class="op">}</span><span class="fst">"</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t371" href="#t371">371</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t372" href="#t372">372</a></span><span class="t">                <span class="fst">f"</span><span class="fst">Execute Project.load_validated_assets(</span><span class="op">{</span><span class="nam">path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">) for project </span><span class="fst">"</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t373" href="#t373">373</a></span><span class="t">                <span class="fst">f"</span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">}</span><span class="fst">"</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t374" href="#t374">374</a></span><span class="t">                <span class="nam">extra</span><span class="op">=</span><span class="op">{</span><span class="str">"timing_ref"</span><span class="op">:</span> <span class="nam">timing_ref</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t375" href="#t375">375</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t376" href="#t376">376</a></span><span class="t">            <span class="com"># noinspection PyTypeChecker</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t377" href="#t377">377</a></span><span class="t">            <span class="nam">saved_objects</span><span class="op">,</span> <span class="nam">exceptions_group</span> <span class="op">=</span> <span class="nam">Helpers</span><span class="op">.</span><span class="nam">converter_from_file_to_object</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t378" href="#t378">378</a></span><span class="t">                <span class="nam">path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t379" href="#t379">379</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t380" href="#t380">380</a></span><span class="t">            <span class="nam">object_count</span> <span class="op">=</span> <span class="nam">len</span><span class="op">(</span><span class="nam">saved_objects</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t381" href="#t381">381</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t382" href="#t382">382</a></span><span class="t">                <span class="fst">f"</span><span class="fst">Execute Project.load_validated_assets(</span><span class="op">{</span><span class="nam">path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">) for project</span><span class="fst">"</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t383" href="#t383">383</a></span><span class="t">                <span class="fst">f"</span><span class="fst"> </span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">}</span><span class="fst"> (</span><span class="op">{</span><span class="nam">object_count</span><span class="op">}</span><span class="fst"> objects)</span><span class="fst">"</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t384" href="#t384">384</a></span><span class="t">                <span class="nam">extra</span><span class="op">=</span><span class="op">{</span><span class="str">"timing_ref"</span><span class="op">:</span> <span class="nam">timing_ref</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t385" href="#t385">385</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t386" href="#t386">386</a></span><span class="t">            <span class="key">return</span> <span class="nam">saved_objects</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t387" href="#t387">387</a></span><span class="t">        <span class="key">return</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t388" href="#t388">388</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t389" href="#t389">389</a></span><span class="t">    <span class="key">async</span> <span class="key">def</span> <span class="nam">save_validated_assets</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">asynchronous</span><span class="op">=</span><span class="key">True</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t390" href="#t390">390</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t391" href="#t391">391</a></span><span class="t"><span class="str">        Saves validated assets to the project quick save directory.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t392" href="#t392">392</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t393" href="#t393">393</a></span><span class="t"><span class="str">        It manages the quick save files by removing old saves and generating a new save file with a unique name.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t394" href="#t394">394</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t395" href="#t395">395</a></span><span class="t"><span class="str">        The format of the save file is: quick_save_{date}_{time}.json:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t396" href="#t396">396</a></span><span class="t"><span class="str">            date:   the date on which the quicksave was made in format yymmdd</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t397" href="#t397">397</a></span><span class="t"><span class="str">            time:   the time on which the quicksave was made in format HHMMSS</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t398" href="#t398">398</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t399" href="#t399">399</a></span><span class="t"><span class="str">        All quicksaves that are more than set days old (default= 7) are deleted in this function.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t400" href="#t400">400</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t401" href="#t401">401</a></span><span class="t"><span class="str">        :param self: The instance of the class managing quick saves.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t402" href="#t402">402</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t403" href="#t403">403</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t404" href="#t404">404</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t405" href="#t405">405</a></span><span class="t"><span class="str">        :raises OSError: If there is an issue creating the quick save directory or saving the file.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t406" href="#t406">406</a></span><span class="t"><span class="str">        @param asynchronous: do the save asynchronous or not</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t407" href="#t407">407</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t408" href="#t408">408</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t409" href="#t409">409</a></span><span class="t">        <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">quick_save_dir_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t410" href="#t410">410</a></span><span class="t">            <span class="nam">current_date</span> <span class="op">=</span> <span class="nam">datetime</span><span class="op">.</span><span class="nam">datetime</span><span class="op">.</span><span class="nam">now</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t411" href="#t411">411</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t412" href="#t412">412</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">remove_too_old_quicksaves</span><span class="op">(</span><span class="nam">current_date</span><span class="op">=</span><span class="nam">current_date</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t413" href="#t413">413</a></span><span class="t">                                          <span class="nam">max_days_stored</span><span class="op">=</span><span class="nam">Project</span><span class="op">.</span><span class="nam">max_days_quicksave_stored</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t414" href="#t414">414</a></span><span class="t">                                          <span class="nam">date_format</span><span class="op">=</span><span class="nam">Project</span><span class="op">.</span><span class="nam">quicksave_date_format</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t415" href="#t415">415</a></span><span class="t">        <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t416" href="#t416">416</a></span><span class="t">            <span class="nam">os</span><span class="op">.</span><span class="nam">mkdir</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">quick_save_dir_path</span> <span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t417" href="#t417">417</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t418" href="#t418">418</a></span><span class="t">        <span class="nam">current_date_str</span> <span class="op">=</span> <span class="nam">datetime</span><span class="op">.</span><span class="nam">datetime</span><span class="op">.</span><span class="nam">now</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="nam">strftime</span><span class="op">(</span><span class="nam">Project</span><span class="op">.</span><span class="nam">quicksave_date_format</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t419" href="#t419">419</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t420" href="#t420">420</a></span><span class="t">        <span class="nam">save_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">quick_save_dir_path</span>  <span class="op">/</span> <span class="fst">f"</span><span class="fst">quick_save-</span><span class="op">{</span><span class="nam">current_date_str</span><span class="op">}</span><span class="fst">.json</span><span class="fst">"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t421" href="#t421">421</a></span><span class="t">        <span class="key">if</span> <span class="nam">asynchronous</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t422" href="#t422">422</a></span><span class="t">            <span class="key">try</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t423" href="#t423">423</a></span><span class="t">                <span class="nam">create_task_reraise_exception</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">make_quick_save_async</span><span class="op">(</span><span class="nam">save_path</span><span class="op">=</span><span class="nam">save_path</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t424" href="#t424">424</a></span><span class="t">            <span class="key">except</span> <span class="nam">DeprecationWarning</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t425" href="#t425">425</a></span><span class="t">                <span class="com"># should only go here if you are testing</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t426" href="#t426">426</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">make_quick_save</span><span class="op">(</span><span class="nam">save_path</span><span class="op">=</span><span class="nam">save_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t427" href="#t427">427</a></span><span class="t">        <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t428" href="#t428">428</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">make_quick_save</span><span class="op">(</span><span class="nam">save_path</span><span class="op">=</span><span class="nam">save_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t429" href="#t429">429</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t430" href="#t430">430</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t431" href="#t431">431</a></span><span class="t">    <span class="key">async</span> <span class="key">def</span> <span class="nam">make_quick_save_async</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">save_path</span><span class="op">:</span> <span class="nam">Path</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t432" href="#t432">432</a></span><span class="t">        <span class="nam">object_count</span> <span class="op">=</span> <span class="nam">len</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">assets_in_memory</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t433" href="#t433">433</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="fst">f"</span><span class="fst">Execute Project.make_quick_save(</span><span class="op">{</span><span class="nam">save_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">) for project </span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">}</span><span class="fst"> (</span><span class="op">{</span><span class="nam">object_count</span><span class="op">}</span><span class="fst"> objects)</span><span class="fst">"</span><span class="op">,</span> <span class="nam">extra</span><span class="op">=</span><span class="op">{</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t434" href="#t434">434</a></span><span class="t">            <span class="str">"timing_ref"</span><span class="op">:</span> <span class="fst">f"</span><span class="fst">make_quick_save_</span><span class="op">{</span><span class="nam">save_path</span><span class="op">.</span><span class="nam">stem</span><span class="op">}</span><span class="fst">"</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t435" href="#t435">435</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t436" href="#t436">436</a></span><span class="t">        <span class="key">await</span> <span class="nam">Helpers</span><span class="op">.</span><span class="nam">from_objects_to_file_async</span><span class="op">(</span><span class="nam">save_path</span><span class="op">,</span><span class="nam">self</span><span class="op">.</span><span class="nam">assets_in_memory</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t437" href="#t437">437</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">last_quick_save</span> <span class="op">=</span> <span class="nam">save_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t438" href="#t438">438</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">save_project_to_dir</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t439" href="#t439">439</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t440" href="#t440">440</a></span><span class="t">            <span class="fst">f"</span><span class="fst">Execute Project.make_quick_save(</span><span class="op">{</span><span class="nam">save_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">) for project </span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">}</span><span class="fst"> (</span><span class="op">{</span><span class="nam">object_count</span><span class="op">}</span><span class="fst"> objects)</span><span class="fst">"</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t441" href="#t441">441</a></span><span class="t">            <span class="nam">extra</span><span class="op">=</span><span class="op">{</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t442" href="#t442">442</a></span><span class="t">                <span class="str">"timing_ref"</span><span class="op">:</span> <span class="fst">f"</span><span class="fst">make_quick_save_</span><span class="op">{</span><span class="nam">save_path</span><span class="op">.</span><span class="nam">stem</span><span class="op">}</span><span class="fst">"</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t443" href="#t443">443</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t444" href="#t444">444</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t445" href="#t445">445</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t446" href="#t446">446</a></span><span class="t">    <span class="key">def</span> <span class="nam">make_quick_save</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">save_path</span><span class="op">:</span> <span class="nam">Path</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t447" href="#t447">447</a></span><span class="t">        <span class="nam">object_count</span> <span class="op">=</span> <span class="nam">len</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">assets_in_memory</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t448" href="#t448">448</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="fst">f"</span><span class="fst">Execute Project.make_quick_save(</span><span class="op">{</span><span class="nam">save_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">) for project </span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">}</span><span class="fst"> (</span><span class="op">{</span><span class="nam">object_count</span><span class="op">}</span><span class="fst"> objects)</span><span class="fst">"</span><span class="op">,</span> <span class="nam">extra</span><span class="op">=</span><span class="op">{</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t449" href="#t449">449</a></span><span class="t">            <span class="str">"timing_ref"</span><span class="op">:</span> <span class="fst">f"</span><span class="fst">make_quick_save_</span><span class="op">{</span><span class="nam">save_path</span><span class="op">.</span><span class="nam">stem</span><span class="op">}</span><span class="fst">"</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t450" href="#t450">450</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t451" href="#t451">451</a></span><span class="t">        <span class="nam">Helpers</span><span class="op">.</span><span class="nam">from_objects_to_file</span><span class="op">(</span><span class="nam">save_path</span><span class="op">,</span><span class="nam">self</span><span class="op">.</span><span class="nam">assets_in_memory</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t452" href="#t452">452</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">last_quick_save</span> <span class="op">=</span> <span class="nam">save_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t453" href="#t453">453</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">save_project_to_dir</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t454" href="#t454">454</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t455" href="#t455">455</a></span><span class="t">            <span class="fst">f"</span><span class="fst">Execute Project.make_quick_save(</span><span class="op">{</span><span class="nam">save_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">) for project </span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">}</span><span class="fst"> (</span><span class="op">{</span><span class="nam">object_count</span><span class="op">}</span><span class="fst"> objects)</span><span class="fst">"</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t456" href="#t456">456</a></span><span class="t">            <span class="nam">extra</span><span class="op">=</span><span class="op">{</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t457" href="#t457">457</a></span><span class="t">                <span class="str">"timing_ref"</span><span class="op">:</span> <span class="fst">f"</span><span class="fst">make_quick_save_</span><span class="op">{</span><span class="nam">save_path</span><span class="op">.</span><span class="nam">stem</span><span class="op">}</span><span class="fst">"</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t458" href="#t458">458</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t459" href="#t459">459</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t460" href="#t460">460</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t461" href="#t461">461</a></span><span class="t">    <span class="key">def</span> <span class="nam">remove_too_old_quicksaves</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">current_date</span><span class="op">:</span> <span class="nam">datetime</span><span class="op">,</span> <span class="nam">max_days_stored</span><span class="op">:</span> <span class="nam">datetime</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t462" href="#t462">462</a></span><span class="t">                                   <span class="nam">date_format</span><span class="op">:</span> <span class="nam">str</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t463" href="#t463">463</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t464" href="#t464">464</a></span><span class="t"><span class="str">        Removes quick save files that are older than a specified number of days.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t465" href="#t465">465</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t466" href="#t466">466</a></span><span class="t"><span class="str">        This function checks the modification dates of the quick save files and deletes those that exceed the maximum age defined by the user.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t467" href="#t467">467</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t468" href="#t468">468</a></span><span class="t"><span class="str">        Files that do not adhere to the standard naming convention are never deleted.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t469" href="#t469">469</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t470" href="#t470">470</a></span><span class="t"><span class="str">        :param self: The instance of the class managing quick saves.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t471" href="#t471">471</a></span><span class="t"><span class="str">        :param current_date: The current date used to compare against quick save file dates.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t472" href="#t472">472</a></span><span class="t"><span class="str">        :type current_date: datetime</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t473" href="#t473">473</a></span><span class="t"><span class="str">        :param max_days_stored: The maximum number of days to retain quick save files.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t474" href="#t474">474</a></span><span class="t"><span class="str">        :type max_days_stored: datetime</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t475" href="#t475">475</a></span><span class="t"><span class="str">        :param date_format: The format used to parse the date from the filename.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t476" href="#t476">476</a></span><span class="t"><span class="str">        :type date_format: str</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t477" href="#t477">477</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t478" href="#t478">478</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t479" href="#t479">479</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t480" href="#t480">480</a></span><span class="t"><span class="str">        :example:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t481" href="#t481">481</a></span><span class="t"><span class="str">            project.remove_too_old_quicksaves(datetime.now(), 30, "%Y-%m-%d")</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t482" href="#t482">482</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t483" href="#t483">483</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t484" href="#t484">484</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t485" href="#t485">485</a></span><span class="t">        <span class="nam">files</span> <span class="op">=</span> <span class="nam">os</span><span class="op">.</span><span class="nam">listdir</span><span class="op">(</span><span class="nam">path</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">quick_save_dir_path</span> <span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t486" href="#t486">486</a></span><span class="t">        <span class="key">for</span> <span class="nam">filename</span> <span class="key">in</span> <span class="nam">files</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t487" href="#t487">487</a></span><span class="t">            <span class="key">try</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t488" href="#t488">488</a></span><span class="t">                <span class="nam">file_date</span> <span class="op">=</span> <span class="nam">datetime</span><span class="op">.</span><span class="nam">datetime</span><span class="op">.</span><span class="nam">strptime</span><span class="op">(</span><span class="nam">filename</span><span class="op">.</span><span class="nam">split</span><span class="op">(</span><span class="str">"-"</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="num">1</span><span class="op">]</span><span class="op">.</span><span class="nam">split</span><span class="op">(</span><span class="str">".json"</span><span class="op">)</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t489" href="#t489">489</a></span><span class="t">                                                       <span class="nam">date_format</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t490" href="#t490">490</a></span><span class="t">            <span class="key">except</span> <span class="nam">ValueError</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t491" href="#t491">491</a></span><span class="t">                <span class="com"># if the save file doesn't adhere to standard naming convention it is never deleted</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t492" href="#t492">492</a></span><span class="t">                <span class="nam">file_date</span> <span class="op">=</span> <span class="nam">current_date</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t493" href="#t493">493</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t494" href="#t494">494</a></span><span class="t">            <span class="nam">days_ago</span> <span class="op">=</span> <span class="op">(</span><span class="nam">current_date</span> <span class="op">-</span> <span class="nam">file_date</span><span class="op">)</span><span class="op">.</span><span class="nam">days</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t495" href="#t495">495</a></span><span class="t">            <span class="key">if</span> <span class="nam">days_ago</span> <span class="op">></span> <span class="nam">max_days_stored</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t496" href="#t496">496</a></span><span class="t">                <span class="nam">file_to_remove_path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">quick_save_dir_path</span> <span class="op">,</span> <span class="nam">filename</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t497" href="#t497">497</a></span><span class="t">                <span class="nam">os</span><span class="op">.</span><span class="nam">remove</span><span class="op">(</span><span class="nam">file_to_remove_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t498" href="#t498">498</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t499" href="#t499">499</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t500" href="#t500">500</a></span><span class="t">    <span class="key">def</span> <span class="nam">export_project_to_file</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">file_path</span><span class="op">:</span> <span class="nam">Path</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t501" href="#t501">501</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t502" href="#t502">502</a></span><span class="t"><span class="str">        Exports the project data to a specified file in OTLW format which is a custom ZIP format.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t503" href="#t503">503</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t504" href="#t504">504</a></span><span class="t"><span class="str">        This method creates a ZIP file containing the project's details,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t505" href="#t505">505</a></span><span class="t"><span class="str">        including the project details file, saved documents overview, subset path, and any saved</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t506" href="#t506">506</a></span><span class="t"><span class="str">        project files. It also includes the last quick save file if it exists, ensuring that all</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t507" href="#t507">507</a></span><span class="t"><span class="str">        relevant project information is packaged together.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t508" href="#t508">508</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t509" href="#t509">509</a></span><span class="t"><span class="str">        :param file_path: The path where the OTLW file will be saved.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t510" href="#t510">510</a></span><span class="t"><span class="str">        :type file_path: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t511" href="#t511">511</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t512" href="#t512">512</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t513" href="#t513">513</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t514" href="#t514">514</a></span><span class="t"><span class="str">        :raises FileNotFoundError: If any of the files to be included in the ZIP do not exist.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t515" href="#t515">515</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t516" href="#t516">516</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t517" href="#t517">517</a></span><span class="t">        <span class="key">with</span> <span class="nam">zipfile</span><span class="op">.</span><span class="nam">ZipFile</span><span class="op">(</span><span class="nam">file</span><span class="op">=</span><span class="nam">file_path</span><span class="op">,</span> <span class="nam">mode</span><span class="op">=</span><span class="str">'w'</span><span class="op">)</span> <span class="key">as</span> <span class="nam">project_zip</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t518" href="#t518">518</a></span><span class="t">            <span class="nam">project_zip</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_details_filename</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t519" href="#t519">519</a></span><span class="t">                              <span class="nam">arcname</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_details_filename</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t520" href="#t520">520</a></span><span class="t">                              <span class="nam">compresslevel</span><span class="op">=</span><span class="nam">zipfile</span><span class="op">.</span><span class="nam">ZIP_DEFLATED</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t521" href="#t521">521</a></span><span class="t">            <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_documents_overview_path</span> <span class="key">and</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_documents_overview_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t522" href="#t522">522</a></span><span class="t">                <span class="nam">project_zip</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">saved_documents_overview_path</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t523" href="#t523">523</a></span><span class="t">                                  <span class="nam">arcname</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">saved_documents_overview_path</span><span class="op">.</span><span class="nam">name</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t524" href="#t524">524</a></span><span class="t">            <span class="nam">project_zip</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">,</span> <span class="nam">arcname</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">.</span><span class="nam">name</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t525" href="#t525">525</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t526" href="#t526">526</a></span><span class="t">            <span class="key">if</span> <span class="key">not</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_saved_projectfiles</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t527" href="#t527">527</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">load_saved_document_filenames</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t528" href="#t528">528</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t529" href="#t529">529</a></span><span class="t">            <span class="com"># tell the user there are files missing</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t530" href="#t530">530</a></span><span class="t">            <span class="nam">missing_project_files</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">check_if_project_files_exist</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t531" href="#t531">531</a></span><span class="t">            <span class="key">if</span> <span class="nam">len</span><span class="op">(</span><span class="nam">missing_project_files</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t532" href="#t532">532</a></span><span class="t">                <span class="nam">message</span> <span class="op">=</span> <span class="nam">GlobalTranslate</span><span class="op">.</span><span class="nam">_</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t533" href="#t533">533</a></span><span class="t">                    <span class="str">"There are files missing that belong to this project:\n"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t534" href="#t534">534</a></span><span class="t">                <span class="key">for</span> <span class="nam">project_file</span> <span class="key">in</span> <span class="nam">missing_project_files</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t535" href="#t535">535</a></span><span class="t">                    <span class="nam">filename</span> <span class="op">=</span> <span class="nam">project_file</span><span class="op">.</span><span class="nam">file_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t536" href="#t536">536</a></span><span class="t">                    <span class="nam">message</span> <span class="op">+=</span> <span class="fst">f"</span><span class="fst">   -</span><span class="op">{</span><span class="nam">filename</span><span class="op">}</span><span class="fst">\n</span><span class="fst">"</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t537" href="#t537">537</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t538" href="#t538">538</a></span><span class="t">                <span class="nam">message</span> <span class="op">+=</span> <span class="nam">GlobalTranslate</span><span class="op">.</span><span class="nam">_</span><span class="op">(</span><span class="str">"Do you still want to export?"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t539" href="#t539">539</a></span><span class="t">                <span class="nam">msgbox</span> <span class="op">=</span> <span class="nam">YesOrNoNotificationWindow</span><span class="op">(</span><span class="nam">message</span><span class="op">=</span><span class="nam">message</span><span class="op">,</span> <span class="nam">title</span><span class="op">=</span><span class="nam">GlobalTranslate</span><span class="op">.</span><span class="nam">_</span><span class="op">(</span><span class="str">"Missing project files"</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t540" href="#t540">540</a></span><span class="t">                <span class="nam">answer</span> <span class="op">=</span> <span class="nam">msgbox</span><span class="op">.</span><span class="nam">exec</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t541" href="#t541">541</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t542" href="#t542">542</a></span><span class="t">                <span class="key">if</span> <span class="nam">answer</span> <span class="op">==</span> <span class="num">65536</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t543" href="#t543">543</a></span><span class="t">                    <span class="key">return</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t544" href="#t544">544</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t545" href="#t545">545</a></span><span class="t">            <span class="key">for</span> <span class="nam">document</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_saved_projectfiles</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t546" href="#t546">546</a></span><span class="t">                <span class="key">if</span> <span class="nam">document</span><span class="op">.</span><span class="nam">file_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t547" href="#t547">547</a></span><span class="t">                    <span class="nam">file_zip_path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_files_foldername</span><span class="op">)</span> <span class="op">/</span> <span class="nam">document</span><span class="op">.</span><span class="nam">file_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t548" href="#t548">548</a></span><span class="t">                    <span class="nam">project_zip</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">document</span><span class="op">.</span><span class="nam">file_path</span><span class="op">,</span> <span class="nam">arcname</span><span class="op">=</span><span class="nam">file_zip_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t549" href="#t549">549</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t550" href="#t550">550</a></span><span class="t">            <span class="nam">last_quick_save_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_last_quick_save_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t551" href="#t551">551</a></span><span class="t">            <span class="key">if</span> <span class="nam">last_quick_save_path</span> <span class="key">and</span> <span class="nam">last_quick_save_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t552" href="#t552">552</a></span><span class="t">                <span class="nam">last_quick_save_zip_path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">quick_saves_foldername</span><span class="op">)</span> <span class="op">/</span> <span class="nam">last_quick_save_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t553" href="#t553">553</a></span><span class="t">                <span class="nam">project_zip</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">last_quick_save_path</span><span class="op">,</span> <span class="nam">arcname</span><span class="op">=</span><span class="nam">last_quick_save_zip_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t554" href="#t554">554</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t555" href="#t555">555</a></span><span class="t">            <span class="nam">visualisation_html_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_current_visuals_html_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t556" href="#t556">556</a></span><span class="t">            <span class="key">if</span> <span class="nam">visualisation_html_path</span> <span class="key">and</span> <span class="nam">visualisation_html_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t557" href="#t557">557</a></span><span class="t">                <span class="nam">visualisation_html_zip_path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t558" href="#t558">558</a></span><span class="t">                    <span class="nam">self</span><span class="op">.</span><span class="nam">visualisation_foldername</span><span class="op">)</span> <span class="op">/</span> <span class="nam">visualisation_html_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t559" href="#t559">559</a></span><span class="t">                <span class="nam">project_zip</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">visualisation_html_path</span><span class="op">,</span> <span class="nam">arcname</span><span class="op">=</span><span class="nam">visualisation_html_zip_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t560" href="#t560">560</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t561" href="#t561">561</a></span><span class="t">            <span class="nam">visualisation_uptodate_json_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_visualisation_python_support_data_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t562" href="#t562">562</a></span><span class="t">            <span class="key">if</span> <span class="nam">visualisation_uptodate_json_path</span> <span class="key">and</span> <span class="nam">visualisation_uptodate_json_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t563" href="#t563">563</a></span><span class="t">                <span class="nam">visualisation_uptodate_json_zip_path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t564" href="#t564">564</a></span><span class="t">                    <span class="nam">self</span><span class="op">.</span><span class="nam">visualisation_foldername</span><span class="op">)</span> <span class="op">/</span> <span class="nam">visualisation_uptodate_json_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t565" href="#t565">565</a></span><span class="t">                <span class="nam">project_zip</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">visualisation_uptodate_json_path</span><span class="op">,</span> <span class="nam">arcname</span><span class="op">=</span><span class="nam">visualisation_uptodate_json_zip_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t566" href="#t566">566</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t567" href="#t567">567</a></span><span class="t">    <span class="op">@</span><span class="nam">classmethod</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t568" href="#t568">568</a></span><span class="t">    <span class="key">def</span> <span class="nam">import_project</span><span class="op">(</span><span class="nam">cls</span><span class="op">,</span> <span class="nam">file_path</span><span class="op">:</span> <span class="nam">Path</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t569" href="#t569">569</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t570" href="#t570">570</a></span><span class="t"><span class="str">        Imports a project from a specified OTLW file which is a custom ZIP format.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t571" href="#t571">571</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t572" href="#t572">572</a></span><span class="t"><span class="str">        This class method extracts project details from a ZIP file and creates a new project directory based on the extracted information. It handles the creation of the project directory and raises an error if the directory already exists.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t573" href="#t573">573</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t574" href="#t574">574</a></span><span class="t"><span class="str">        :param file_path: The path to the OTLW file containing the project data.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t575" href="#t575">575</a></span><span class="t"><span class="str">        :type file_path: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t576" href="#t576">576</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t577" href="#t577">577</a></span><span class="t"><span class="str">        :return: An instance of the Project class initialized with the imported project details.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t578" href="#t578">578</a></span><span class="t"><span class="str">        :rtype: Self</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t579" href="#t579">579</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t580" href="#t580">580</a></span><span class="t"><span class="str">        :raises FileExistsError: If the project directory already exists.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t581" href="#t581">581</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t582" href="#t582">582</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t583" href="#t583">583</a></span><span class="t">        <span class="key">with</span> <span class="nam">zipfile</span><span class="op">.</span><span class="nam">ZipFile</span><span class="op">(</span><span class="nam">file</span><span class="op">=</span><span class="nam">file_path</span><span class="op">)</span> <span class="key">as</span> <span class="nam">project_file</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t584" href="#t584">584</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t585" href="#t585">585</a></span><span class="t">            <span class="com"># TODO: handle if project doesn't contain project_details.json files</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t586" href="#t586">586</a></span><span class="t">            <span class="nam">project_details</span> <span class="op">=</span> <span class="nam">json</span><span class="op">.</span><span class="nam">load</span><span class="op">(</span><span class="nam">fp</span><span class="op">=</span><span class="nam">project_file</span><span class="op">.</span><span class="nam">open</span><span class="op">(</span><span class="nam">cls</span><span class="op">.</span><span class="nam">project_details_filename</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t587" href="#t587">587</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t588" href="#t588">588</a></span><span class="t">            <span class="nam">project_dir_path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t589" href="#t589">589</a></span><span class="t">                <span class="nam">ProgramFileStructure</span><span class="op">.</span><span class="nam">get_otl_wizard_projects_dir</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="nam">project_details</span><span class="op">[</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t590" href="#t590">590</a></span><span class="t">                    <span class="str">'eigen_referentie'</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t591" href="#t591">591</a></span><span class="t">            <span class="key">try</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t592" href="#t592">592</a></span><span class="t">                <span class="nam">project_dir_path</span><span class="op">.</span><span class="nam">mkdir</span><span class="op">(</span><span class="nam">exist_ok</span><span class="op">=</span><span class="key">False</span><span class="op">,</span> <span class="nam">parents</span><span class="op">=</span><span class="key">True</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t593" href="#t593">593</a></span><span class="t">            <span class="key">except</span> <span class="nam">FileExistsError</span> <span class="key">as</span> <span class="nam">ex</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t594" href="#t594">594</a></span><span class="t">                <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">error</span><span class="op">(</span><span class="str">"Project dir %s already exists"</span><span class="op">,</span> <span class="nam">project_dir_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t595" href="#t595">595</a></span><span class="t">                <span class="key">raise</span> <span class="nam">ProjectExistsError</span><span class="op">(</span><span class="nam">eigen_referentie</span><span class="op">=</span><span class="nam">project_details</span><span class="op">[</span><span class="str">'eigen_referentie'</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t596" href="#t596">596</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t597" href="#t597">597</a></span><span class="t">            <span class="nam">project_file</span><span class="op">.</span><span class="nam">extractall</span><span class="op">(</span><span class="nam">path</span><span class="op">=</span><span class="nam">project_dir_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t598" href="#t598">598</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t599" href="#t599">599</a></span><span class="t">        <span class="key">return</span> <span class="nam">Project</span><span class="op">.</span><span class="nam">load_project</span><span class="op">(</span><span class="nam">project_path</span><span class="op">=</span><span class="nam">project_dir_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t600" href="#t600">600</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t601" href="#t601">601</a></span><span class="t">    <span class="key">def</span> <span class="nam">delete_project_dir_by_path</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t602" href="#t602">602</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t603" href="#t603">603</a></span><span class="t"><span class="str">        Deletes the project directory specified by the project's path.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t604" href="#t604">604</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t605" href="#t605">605</a></span><span class="t"><span class="str">        This method removes the entire directory associated with the project, including all its contents. It logs the deletion action for debugging purposes.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t606" href="#t606">606</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t607" href="#t607">607</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t608" href="#t608">608</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t609" href="#t609">609</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t610" href="#t610">610</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="str">"Deleting project %s"</span><span class="op">,</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t611" href="#t611">611</a></span><span class="t">        <span class="nam">shutil</span><span class="op">.</span><span class="nam">rmtree</span><span class="op">(</span><span class="nam">path</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t612" href="#t612">612</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t613" href="#t613">613</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t614" href="#t614">614</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t615" href="#t615">615</a></span><span class="t">    <span class="key">def</span> <span class="nam">are_all_project_files_in_memory_valid</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">bool</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t616" href="#t616">616</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t617" href="#t617">617</a></span><span class="t"><span class="str">        Checks if all project files currently in memory are valid.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t618" href="#t618">618</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t619" href="#t619">619</a></span><span class="t"><span class="str">        This method evaluates the state of saved project files to determine if at least one file</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t620" href="#t620">620</a></span><span class="t"><span class="str">        meets the required validity criteria. It logs the process and returns a boolean indicating</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t621" href="#t621">621</a></span><span class="t"><span class="str">        whether any project files are valid.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t622" href="#t622">622</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t623" href="#t623">623</a></span><span class="t"><span class="str">        :return: True if at least one project file is valid; otherwise, False.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t624" href="#t624">624</a></span><span class="t"><span class="str">        :rtype: bool</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t625" href="#t625">625</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t626" href="#t626">626</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t627" href="#t627">627</a></span><span class="t">        <span class="com"># OTLLogger.logger.debug("Started searching for project files in memory that are OTL conform")</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t628" href="#t628">628</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t629" href="#t629">629</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t630" href="#t630">630</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="str">"No project files in memory"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t631" href="#t631">631</a></span><span class="t">            <span class="key">return</span> <span class="key">False</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t632" href="#t632">632</a></span><span class="t">        <span class="key">return</span> <span class="nam">all</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t633" href="#t633">633</a></span><span class="t">            <span class="nam">template</span><span class="op">.</span><span class="nam">state</span> <span class="op">==</span> <span class="nam">FileState</span><span class="op">.</span><span class="nam">OK</span> <span class="key">for</span> <span class="nam">template</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t634" href="#t634">634</a></span><span class="t">        <span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t635" href="#t635">635</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t636" href="#t636">636</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_subset_db_name</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">str</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t637" href="#t637">637</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t638" href="#t638">638</a></span><span class="t"><span class="str">        Retrieves the name of the subset database associated with the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t639" href="#t639">639</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t640" href="#t640">640</a></span><span class="t"><span class="str">        This function returns the name of the subset path as a string.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t641" href="#t641">641</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t642" href="#t642">642</a></span><span class="t"><span class="str">        :return: The name of the subset database.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t643" href="#t643">643</a></span><span class="t"><span class="str">        :rtype: str</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t644" href="#t644">644</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t645" href="#t645">645</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t646" href="#t646">646</a></span><span class="t">        <span class="key">return</span>  <span class="nam">str</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">.</span><span class="nam">name</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t647" href="#t647">647</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t648" href="#t648">648</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_model_builder</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">ModelBuilder</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t649" href="#t649">649</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t650" href="#t650">650</a></span><span class="t"><span class="str">        Loads and initializes the model builder associated with the project if it has not been</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t651" href="#t651">651</a></span><span class="t"><span class="str">        created yet.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t652" href="#t652">652</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t653" href="#t653">653</a></span><span class="t"><span class="str">        This function checks if the model builder is already set and creates a new instance using</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t654" href="#t654">654</a></span><span class="t"><span class="str">        the subset path if necessary.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t655" href="#t655">655</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t656" href="#t656">656</a></span><span class="t"><span class="str">        :return: The model builder instance associated with the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t657" href="#t657">657</a></span><span class="t"><span class="str">        :rtype: ModelBuilder</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t658" href="#t658">658</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t659" href="#t659">659</a></span><span class="t"><span class="str">        :raises ValueError: If the subset path is not set when attempting to create the model</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t660" href="#t660">660</a></span><span class="t"><span class="str">                            builder.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t661" href="#t661">661</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t662" href="#t662">662</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t663" href="#t663">663</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t664" href="#t664">664</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">self</span><span class="op">.</span><span class="nam">model_builder</span> <span class="key">and</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t665" href="#t665">665</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">model_builder</span> <span class="op">=</span> <span class="nam">ModelBuilder</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t666" href="#t666">666</a></span><span class="t">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">model_builder</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t667" href="#t667">667</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t668" href="#t668">668</a></span><span class="t">    <span class="key">def</span> <span class="nam">clear_model_builder_from_memory</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t669" href="#t669">669</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t670" href="#t670">670</a></span><span class="t"><span class="str">        Clears the model builder from memory by setting it to None.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t671" href="#t671">671</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t672" href="#t672">672</a></span><span class="t"><span class="str">        This function effectively releases the reference to the current model builder, allowing for garbage collection.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t673" href="#t673">673</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t674" href="#t674">674</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t675" href="#t675">675</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t676" href="#t676">676</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t677" href="#t677">677</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">model_builder</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t678" href="#t678">678</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t679" href="#t679">679</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_operator_name</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">str</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t680" href="#t680">680</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t681" href="#t681">681</a></span><span class="t"><span class="str">        Retrieves the name of the subset operator associated with the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t682" href="#t682">682</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t683" href="#t683">683</a></span><span class="t"><span class="str">        If the subset operator is not already set, it fetches the operator name from the model builder and processes it accordingly.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t684" href="#t684">684</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t685" href="#t685">685</a></span><span class="t"><span class="str">        :return: The name of the subset operator.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t686" href="#t686">686</a></span><span class="t"><span class="str">        :rtype: str</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t687" href="#t687">687</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t688" href="#t688">688</a></span><span class="t"><span class="str">        :raises ValueError: If the operator name cannot be determined from the model builder.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t689" href="#t689">689</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t690" href="#t690">690</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t691" href="#t691">691</a></span><span class="t">        <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span> <span class="key">and</span> <span class="key">not</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_operator</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t692" href="#t692">692</a></span><span class="t">            <span class="nam">subset_operator</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_model_builder</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="nam">get_operator_name</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t693" href="#t693">693</a></span><span class="t">            <span class="key">if</span> <span class="nam">isinstance</span><span class="op">(</span><span class="nam">subset_operator</span><span class="op">,</span><span class="nam">Path</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t694" href="#t694">694</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">subset_operator</span> <span class="op">=</span> <span class="nam">cast</span><span class="op">(</span><span class="nam">Path</span><span class="op">,</span><span class="nam">subset_operator</span><span class="op">)</span><span class="op">.</span><span class="nam">stem</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t695" href="#t695">695</a></span><span class="t">            <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t696" href="#t696">696</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">subset_operator</span> <span class="op">=</span> <span class="nam">subset_operator</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t697" href="#t697">697</a></span><span class="t">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_operator</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t698" href="#t698">698</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t699" href="#t699">699</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_otl_version</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">str</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t700" href="#t700">700</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t701" href="#t701">701</a></span><span class="t"><span class="str">        Retrieves the OTL (Object Type Library) version associated with the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t702" href="#t702">702</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t703" href="#t703">703</a></span><span class="t"><span class="str">        If the OTL version is not already set, it fetches the version from the model builder.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t704" href="#t704">704</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t705" href="#t705">705</a></span><span class="t"><span class="str">        :return: The OTL version.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t706" href="#t706">706</a></span><span class="t"><span class="str">        :rtype: str</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t707" href="#t707">707</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t708" href="#t708">708</a></span><span class="t"><span class="str">        :raises ValueError: If the OTL version cannot be determined from the model builder.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t709" href="#t709">709</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t710" href="#t710">710</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t711" href="#t711">711</a></span><span class="t">        <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span> <span class="key">and</span> <span class="key">not</span> <span class="nam">self</span><span class="op">.</span><span class="nam">otl_version</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t712" href="#t712">712</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">otl_version</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_model_builder</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="nam">get_otl_version</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t713" href="#t713">713</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t714" href="#t714">714</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t715" href="#t715">715</a></span><span class="t">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">otl_version</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t716" href="#t716">716</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t717" href="#t717">717</a></span><span class="t">    <span class="key">def</span> <span class="nam">load_saved_document_filenames</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t718" href="#t718">718</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t719" href="#t719">719</a></span><span class="t"><span class="str">        Loads the filenames of saved documents associated with the project from a specified directory.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t720" href="#t720">720</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t721" href="#t721">721</a></span><span class="t"><span class="str">        This function checks for the existence of a saved documents file, reads its contents, and populates the list of saved project files with their saved states. If there are no quicksaves yet then the states are set to FileState.WARNING.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t722" href="#t722">722</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t723" href="#t723">723</a></span><span class="t"><span class="str">        :return: The instance of the class, allowing for method chaining.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t724" href="#t724">724</a></span><span class="t"><span class="str">        :rtype: self</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t725" href="#t725">725</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t726" href="#t726">726</a></span><span class="t"><span class="str">        :raises FileNotFoundError: If the saved documents file does not exist.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t727" href="#t727">727</a></span><span class="t"><span class="str">        :raises json.JSONDecodeError: If the saved documents file contains invalid JSON.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t728" href="#t728">728</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t729" href="#t729">729</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t730" href="#t730">730</a></span><span class="t">        <span class="nam">project_dir_path</span> <span class="op">=</span> <span class="nam">ProgramFileStructure</span><span class="op">.</span><span class="nam">get_otl_wizard_projects_dir</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t731" href="#t731">731</a></span><span class="t">        <span class="nam">saved_documents_path</span><span class="op">:</span> <span class="nam">Path</span> <span class="op">=</span> <span class="nam">project_dir_path</span> <span class="op">/</span> <span class="nam">Project</span><span class="op">.</span><span class="nam">saved_documents_filename</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t732" href="#t732">732</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t733" href="#t733">733</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t734" href="#t734">734</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t735" href="#t735">735</a></span><span class="t">        <span class="key">if</span> <span class="nam">saved_documents_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t736" href="#t736">736</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t737" href="#t737">737</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t738" href="#t738">738</a></span><span class="t">                <span class="fst">f"</span><span class="fst">Loading saved documents: </span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">/</span><span class="op">{</span><span class="nam">Project</span><span class="op">.</span><span class="nam">saved_documents_filename</span><span class="op">}</span><span class="fst">"</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t739" href="#t739">739</a></span><span class="t">                <span class="nam">extra</span><span class="op">=</span><span class="op">{</span><span class="str">"timing_ref"</span><span class="op">:</span> <span class="fst">f"</span><span class="fst">load_quicksave_</span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">"</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t740" href="#t740">740</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t741" href="#t741">741</a></span><span class="t">            <span class="key">with</span> <span class="nam">open</span><span class="op">(</span><span class="nam">file</span><span class="op">=</span><span class="nam">saved_documents_path</span><span class="op">,</span><span class="nam">mode</span><span class="op">=</span><span class="str">"r"</span><span class="op">)</span> <span class="key">as</span> <span class="nam">saved_document</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t742" href="#t742">742</a></span><span class="t">                <span class="key">try</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t743" href="#t743">743</a></span><span class="t">                    <span class="nam">saved_documents</span> <span class="op">=</span> <span class="nam">json</span><span class="op">.</span><span class="nam">load</span><span class="op">(</span><span class="nam">fp</span><span class="op">=</span><span class="nam">saved_document</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t744" href="#t744">744</a></span><span class="t">                <span class="key">except</span> <span class="nam">json</span><span class="op">.</span><span class="nam">decoder</span><span class="op">.</span><span class="nam">JSONDecodeError</span> <span class="key">as</span> <span class="nam">e</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t745" href="#t745">745</a></span><span class="t">                    <span class="com"># happens when the saved_documents.json file is empty</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t746" href="#t746">746</a></span><span class="t">                    <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">warning</span><span class="op">(</span><span class="nam">e</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t747" href="#t747">747</a></span><span class="t">                    <span class="nam">saved_documents</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t748" href="#t748">748</a></span><span class="t">            <span class="nam">saved_documents_str</span> <span class="op">=</span> <span class="nam">str</span><span class="op">(</span><span class="nam">saved_documents</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t749" href="#t749">749</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t750" href="#t750">750</a></span><span class="t">            <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t751" href="#t751">751</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t752" href="#t752">752</a></span><span class="t">            <span class="nam">location_dir</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_project_files_dir_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t753" href="#t753">753</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t754" href="#t754">754</a></span><span class="t">            <span class="com">#copy all files from the old OTL-Template-files folder to the new folder</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t755" href="#t755">755</a></span><span class="t">            <span class="key">if</span> <span class="key">not</span> <span class="nam">location_dir</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t756" href="#t756">756</a></span><span class="t">                <span class="nam">location_dir</span><span class="op">.</span><span class="nam">mkdir</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t757" href="#t757">757</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t758" href="#t758">758</a></span><span class="t">            <span class="nam">old_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_old_project_files_dir_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t759" href="#t759">759</a></span><span class="t">            <span class="key">if</span> <span class="nam">old_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t760" href="#t760">760</a></span><span class="t">                <span class="key">for</span> <span class="nam">location</span><span class="op">,</span> <span class="nam">dirs</span><span class="op">,</span> <span class="nam">files</span> <span class="key">in</span> <span class="nam">os</span><span class="op">.</span><span class="nam">walk</span><span class="op">(</span><span class="nam">old_path</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t761" href="#t761">761</a></span><span class="t">                    <span class="key">for</span> <span class="nam">file</span> <span class="key">in</span> <span class="nam">files</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t762" href="#t762">762</a></span><span class="t">                        <span class="nam">old_location</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">location</span><span class="op">,</span> <span class="nam">file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t763" href="#t763">763</a></span><span class="t">                        <span class="nam">new_location</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">location_dir</span> <span class="op">,</span> <span class="nam">file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t764" href="#t764">764</a></span><span class="t">                        <span class="nam">shutil</span><span class="op">.</span><span class="nam">copyfile</span><span class="op">(</span><span class="nam">old_location</span><span class="op">,</span> <span class="nam">new_location</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t765" href="#t765">765</a></span><span class="t">                        <span class="nam">os</span><span class="op">.</span><span class="nam">remove</span><span class="op">(</span><span class="nam">old_location</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t766" href="#t766">766</a></span><span class="t">                <span class="nam">old_path</span><span class="op">.</span><span class="nam">rmdir</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t767" href="#t767">767</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t768" href="#t768">768</a></span><span class="t">            <span class="key">for</span> <span class="nam">document</span> <span class="key">in</span> <span class="nam">saved_documents</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t769" href="#t769">769</a></span><span class="t">                <span class="com"># if document was validated but there is no quicksave then set it to warning</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t770" href="#t770">770</a></span><span class="t">                <span class="nam">state</span> <span class="op">=</span> <span class="nam">FileState</span><span class="op">(</span><span class="nam">document</span><span class="op">[</span><span class="str">'state'</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t771" href="#t771">771</a></span><span class="t">                <span class="nam">quick_save_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_quicksaves_dir_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t772" href="#t772">772</a></span><span class="t">                <span class="nam">document_file_path</span> <span class="op">=</span> <span class="nam">location_dir</span> <span class="op">/</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">document</span><span class="op">[</span><span class="str">'file_path'</span><span class="op">]</span><span class="op">)</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t773" href="#t773">773</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t774" href="#t774">774</a></span><span class="t">                <span class="key">if</span> <span class="op">(</span><span class="nam">state</span> <span class="op">==</span> <span class="nam">FileState</span><span class="op">.</span><span class="nam">OK</span> <span class="key">and</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t775" href="#t775">775</a></span><span class="t">                    <span class="key">not</span> <span class="op">(</span><span class="nam">quick_save_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span> <span class="key">and</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t776" href="#t776">776</a></span><span class="t">                     <span class="nam">len</span><span class="op">(</span><span class="nam">list</span><span class="op">(</span><span class="nam">os</span><span class="op">.</span><span class="nam">listdir</span><span class="op">(</span><span class="nam">path</span><span class="op">=</span><span class="nam">quick_save_path</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t777" href="#t777">777</a></span><span class="t">                    <span class="nam">state</span> <span class="op">=</span> <span class="nam">FileState</span><span class="op">.</span><span class="nam">WARNING</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t778" href="#t778">778</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t779" href="#t779">779</a></span><span class="t">                <span class="nam">file</span> <span class="op">=</span> <span class="nam">ProjectFile</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t780" href="#t780">780</a></span><span class="t">                    <span class="nam">file_path</span><span class="op">=</span><span class="nam">location_dir</span> <span class="op">/</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">document</span><span class="op">[</span><span class="str">'file_path'</span><span class="op">]</span><span class="op">)</span><span class="op">.</span><span class="nam">name</span> <span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t781" href="#t781">781</a></span><span class="t">                    <span class="nam">state</span><span class="op">=</span><span class="nam">state</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t782" href="#t782">782</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t783" href="#t783">783</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t784" href="#t784">784</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t785" href="#t785">785</a></span><span class="t">                <span class="fst">f"</span><span class="fst">Loading saved documents: </span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">/</span><span class="op">{</span><span class="nam">Project</span><span class="op">.</span><span class="nam">saved_documents_filename</span><span class="op">}</span><span class="fst">"</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t786" href="#t786">786</a></span><span class="t">                <span class="nam">extra</span><span class="op">=</span><span class="op">{</span><span class="str">"timing_ref"</span><span class="op">:</span> <span class="fst">f"</span><span class="fst">load_quicksave_</span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst">"</span><span class="op">}</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t787" href="#t787">787</a></span><span class="t">        <span class="key">return</span> <span class="nam">self</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t788" href="#t788">788</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t789" href="#t789">789</a></span><span class="t">    <span class="key">def</span> <span class="nam">check_if_project_files_exist</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">list</span><span class="op">[</span><span class="nam">ProjectFile</span><span class="op">]</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t790" href="#t790">790</a></span><span class="t">        <span class="nam">missing_project_files</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t791" href="#t791">791</a></span><span class="t">        <span class="key">for</span> <span class="nam">project_file</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_saved_projectfiles</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t792" href="#t792">792</a></span><span class="t">            <span class="key">if</span> <span class="key">not</span> <span class="nam">project_file</span><span class="op">.</span><span class="nam">file_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t793" href="#t793">793</a></span><span class="t">                <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">info</span><span class="op">(</span><span class="fst">f'</span><span class="fst">project "</span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">}</span><span class="fst">" is missing file: </span><span class="op">{</span><span class="nam">project_file</span><span class="op">.</span><span class="nam">file_path</span><span class="op">}</span><span class="fst">'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t794" href="#t794">794</a></span><span class="t">                <span class="nam">missing_project_files</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">project_file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t795" href="#t795">795</a></span><span class="t">                <span class="nam">project_file</span><span class="op">.</span><span class="nam">state</span> <span class="op">=</span> <span class="nam">FileState</span><span class="op">.</span><span class="nam">ERROR</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t796" href="#t796">796</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t797" href="#t797">797</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t798" href="#t798">798</a></span><span class="t">        <span class="key">return</span> <span class="nam">missing_project_files</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t799" href="#t799">799</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t800" href="#t800">800</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_quicksaves_dir_path</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">Path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t801" href="#t801">801</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t802" href="#t802">802</a></span><span class="t"><span class="str">        Retrieves the path to the quick saves directory for the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t803" href="#t803">803</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t804" href="#t804">804</a></span><span class="t"><span class="str">        If the directory does not exist, it creates it before returning the path.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t805" href="#t805">805</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t806" href="#t806">806</a></span><span class="t"><span class="str">        :return: The path to the quick saves directory.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t807" href="#t807">807</a></span><span class="t"><span class="str">        :rtype: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t808" href="#t808">808</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t809" href="#t809">809</a></span><span class="t"><span class="str">        :raises OSError: If the directory cannot be created due to a file system error.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t810" href="#t810">810</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t811" href="#t811">811</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t812" href="#t812">812</a></span><span class="t">        <span class="nam">quick_saves</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">quick_saves_foldername</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t813" href="#t813">813</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">quick_saves</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span> <span class="key">and</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t814" href="#t814">814</a></span><span class="t">            <span class="nam">os</span><span class="op">.</span><span class="nam">mkdir</span><span class="op">(</span><span class="nam">Path</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">quick_saves_foldername</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t815" href="#t815">815</a></span><span class="t">        <span class="key">return</span> <span class="nam">quick_saves</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t816" href="#t816">816</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t817" href="#t817">817</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_last_quick_save_path</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">Optional</span><span class="op">[</span><span class="nam">Path</span><span class="op">]</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t818" href="#t818">818</a></span><span class="t">        <span class="com"># sourcery skip: use-named-expression</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t819" href="#t819">819</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t820" href="#t820">820</a></span><span class="t"><span class="str">        Retrieves the path to the last quick save file for the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t821" href="#t821">821</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t822" href="#t822">822</a></span><span class="t"><span class="str">        It first checks if there is a specific last quick save path and if that exists; if not, it looks for the most recent file in the quick saves directory.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t823" href="#t823">823</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t824" href="#t824">824</a></span><span class="t"><span class="str">        :return: The path to the last quick save file, or None if no quick save exists.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t825" href="#t825">825</a></span><span class="t"><span class="str">        :rtype: Optional[Path]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t826" href="#t826">826</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t827" href="#t827">827</a></span><span class="t"><span class="str">        :raises OSError: If there is an issue accessing the quick saves directory.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t828" href="#t828">828</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t829" href="#t829">829</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t830" href="#t830">830</a></span><span class="t">        <span class="nam">path</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t831" href="#t831">831</a></span><span class="t">        <span class="nam">quick_save_path_dir</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_quicksaves_dir_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t832" href="#t832">832</a></span><span class="t">        <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">last_quick_save</span> <span class="key">and</span> <span class="nam">self</span><span class="op">.</span><span class="nam">last_quick_save</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t833" href="#t833">833</a></span><span class="t">            <span class="nam">path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">last_quick_save</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t834" href="#t834">834</a></span><span class="t">        <span class="key">elif</span> <span class="nam">quick_save_path_dir</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t835" href="#t835">835</a></span><span class="t">            <span class="nam">file_list</span> <span class="op">=</span> <span class="nam">sorted</span><span class="op">(</span><span class="nam">os</span><span class="op">.</span><span class="nam">listdir</span><span class="op">(</span><span class="nam">quick_save_path_dir</span><span class="op">)</span><span class="op">,</span> <span class="nam">reverse</span><span class="op">=</span><span class="key">True</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t836" href="#t836">836</a></span><span class="t">            <span class="key">if</span> <span class="nam">file_list</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t837" href="#t837">837</a></span><span class="t">                <span class="nam">path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">quick_save_path_dir</span><span class="op">,</span> <span class="nam">file_list</span><span class="op">[</span><span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t838" href="#t838">838</a></span><span class="t">        <span class="key">return</span> <span class="nam">path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t839" href="#t839">839</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t840" href="#t840">840</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_project_files_dir_path</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">Path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t841" href="#t841">841</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t842" href="#t842">842</a></span><span class="t"><span class="str">        Retrieves the directory path for the project's files.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t843" href="#t843">843</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t844" href="#t844">844</a></span><span class="t"><span class="str">        This function constructs and returns the full path to the folder designated for storing project files.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t845" href="#t845">845</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t846" href="#t846">846</a></span><span class="t"><span class="str">        :param self: The instance of the class managing the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t847" href="#t847">847</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t848" href="#t848">848</a></span><span class="t"><span class="str">        :return: The path to the project files directory.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t849" href="#t849">849</a></span><span class="t"><span class="str">        :rtype: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t850" href="#t850">850</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t851" href="#t851">851</a></span><span class="t"><span class="str">        :example:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t852" href="#t852">852</a></span><span class="t"><span class="str">            files_dir = project.get_project_files_dir_path()</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t853" href="#t853">853</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t854" href="#t854">854</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t855" href="#t855">855</a></span><span class="t">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_files_foldername</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t856" href="#t856">856</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t857" href="#t857">857</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_old_project_files_dir_path</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">Path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t858" href="#t858">858</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t859" href="#t859">859</a></span><span class="t"><span class="str">        Retrieves the directory path for the old project's files.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t860" href="#t860">860</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t861" href="#t861">861</a></span><span class="t"><span class="str">        This function constructs and returns the full path to the folder designated for storing project files in projects made with an old version of OTL wizard.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t862" href="#t862">862</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t863" href="#t863">863</a></span><span class="t"><span class="str">        :param self: The instance of the class managing the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t864" href="#t864">864</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t865" href="#t865">865</a></span><span class="t"><span class="str">        :return: The path to the old project files directory.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t866" href="#t866">866</a></span><span class="t"><span class="str">        :rtype: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t867" href="#t867">867</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t868" href="#t868">868</a></span><span class="t"><span class="str">        :example:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t869" href="#t869">869</a></span><span class="t"><span class="str">            old_files_dir = project.get_old_project_files_dir_path()</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t870" href="#t870">870</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t871" href="#t871">871</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t872" href="#t872">872</a></span><span class="t">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">old_project_files_foldername</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t873" href="#t873">873</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t874" href="#t874">874</a></span><span class="t">    <span class="key">def</span> <span class="nam">delete_template_folder</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t875" href="#t875">875</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t876" href="#t876">876</a></span><span class="t"><span class="str">        Deletes the template folders associated with the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t877" href="#t877">877</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t878" href="#t878">878</a></span><span class="t"><span class="str">        This method removes both the old and new project files directories, effectively clearing</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t879" href="#t879">879</a></span><span class="t"><span class="str">        out all template files. It logs the start and completion of the deletion process for</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t880" href="#t880">880</a></span><span class="t"><span class="str">        debugging purposes.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t881" href="#t881">881</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t882" href="#t882">882</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t883" href="#t883">883</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t884" href="#t884">884</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t885" href="#t885">885</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="fst">f"</span><span class="fst">Started clearing out the whole template folder of </span><span class="fst">"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t886" href="#t886">886</a></span><span class="t">                      <span class="fst">f"</span><span class="fst">project: </span><span class="op">{</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">}</span><span class="fst">"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t887" href="#t887">887</a></span><span class="t">        <span class="nam">new_project_files_folder</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_project_files_dir_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t888" href="#t888">888</a></span><span class="t">        <span class="nam">old_project_files_folder</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_old_project_files_dir_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t889" href="#t889">889</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t890" href="#t890">890</a></span><span class="t">        <span class="key">if</span> <span class="nam">old_project_files_folder</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t891" href="#t891">891</a></span><span class="t">            <span class="nam">shutil</span><span class="op">.</span><span class="nam">rmtree</span><span class="op">(</span><span class="nam">path</span><span class="op">=</span><span class="nam">old_project_files_folder</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t892" href="#t892">892</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t893" href="#t893">893</a></span><span class="t">        <span class="key">if</span> <span class="nam">new_project_files_folder</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t894" href="#t894">894</a></span><span class="t">            <span class="nam">shutil</span><span class="op">.</span><span class="nam">rmtree</span><span class="op">(</span><span class="nam">path</span><span class="op">=</span><span class="nam">new_project_files_folder</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t895" href="#t895">895</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t896" href="#t896">896</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="str">"Finished clearing out the whole template folder"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t897" href="#t897">897</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t898" href="#t898">898</a></span><span class="t">    <span class="key">def</span> <span class="nam">save_project_filepaths_to_file</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t899" href="#t899">899</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t900" href="#t900">900</a></span><span class="t"><span class="str">        Saves the file paths and states of the project's saved files to a JSON file.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t901" href="#t901">901</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t902" href="#t902">902</a></span><span class="t"><span class="str">        This function constructs a list of saved project file details and writes them to a specified file within the project's directory. It will overwrite the existing saved_documents.json.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t903" href="#t903">903</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t904" href="#t904">904</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t905" href="#t905">905</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t906" href="#t906">906</a></span><span class="t"><span class="str">        :raises OSError: If there is an issue writing to the file or accessing the project directory.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t907" href="#t907">907</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t908" href="#t908">908</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t909" href="#t909">909</a></span><span class="t">        <span class="nam">otl_wizard_project_dir</span> <span class="op">=</span> <span class="nam">ProgramFileStructure</span><span class="op">.</span><span class="nam">get_otl_wizard_projects_dir</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t910" href="#t910">910</a></span><span class="t">        <span class="nam">object_array</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t911" href="#t911">911</a></span><span class="t">        <span class="key">for</span> <span class="nam">objects_list</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t912" href="#t912">912</a></span><span class="t">            <span class="nam">objects_list_details</span> <span class="op">=</span> <span class="op">{</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t913" href="#t913">913</a></span><span class="t">                <span class="str">'file_path'</span><span class="op">:</span> <span class="nam">str</span><span class="op">(</span><span class="nam">objects_list</span><span class="op">.</span><span class="nam">file_path</span><span class="op">.</span><span class="nam">name</span><span class="op">)</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t914" href="#t914">914</a></span><span class="t">                <span class="str">'state'</span><span class="op">:</span> <span class="nam">objects_list</span><span class="op">.</span><span class="nam">state</span><span class="op">.</span><span class="nam">value</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t915" href="#t915">915</a></span><span class="t">            <span class="op">}</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t916" href="#t916">916</a></span><span class="t">            <span class="nam">object_array</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">objects_list_details</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t917" href="#t917">917</a></span><span class="t">        <span class="nam">project_dir_path</span> <span class="op">=</span> <span class="nam">otl_wizard_project_dir</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t918" href="#t918">918</a></span><span class="t">        <span class="key">with</span> <span class="nam">open</span><span class="op">(</span><span class="nam">file</span><span class="op">=</span><span class="nam">project_dir_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_documents_filename</span><span class="op">,</span> <span class="nam">mode</span><span class="op">=</span><span class="str">"w+"</span><span class="op">)</span> <span class="key">as</span> <span class="nam">project_details_file</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t919" href="#t919">919</a></span><span class="t">            <span class="nam">json</span><span class="op">.</span><span class="nam">dump</span><span class="op">(</span><span class="nam">object_array</span><span class="op">,</span> <span class="nam">project_details_file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t920" href="#t920">920</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t921" href="#t921">921</a></span><span class="t">    <span class="key">def</span> <span class="nam">is_in_project</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">file_path</span><span class="op">)</span> <span class="op">-></span> <span class="nam">ProjectFile</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t922" href="#t922">922</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t923" href="#t923">923</a></span><span class="t"><span class="str">        Checks if a specified file path is present in the project's saved files.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t924" href="#t924">924</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t925" href="#t925">925</a></span><span class="t"><span class="str">        This function searches through the list of saved project files and returns the matching project file if found, or None if no match exists.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t926" href="#t926">926</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t927" href="#t927">927</a></span><span class="t"><span class="str">        :param file_path: The path of the file to check for in the project's saved files.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t928" href="#t928">928</a></span><span class="t"><span class="str">        :type file_path: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t929" href="#t929">929</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t930" href="#t930">930</a></span><span class="t"><span class="str">        :return: The matching project file if found, or None if not.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t931" href="#t931">931</a></span><span class="t"><span class="str">        :rtype: ProjectFile</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t932" href="#t932">932</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t933" href="#t933">933</a></span><span class="t"><span class="str">        :raises TypeError: If the provided file_path is not of the expected type.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t934" href="#t934">934</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t935" href="#t935">935</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t936" href="#t936">936</a></span><span class="t">        <span class="nam">matches</span> <span class="op">=</span> <span class="op">[</span><span class="nam">project_file</span> <span class="key">for</span> <span class="nam">project_file</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span> <span class="key">if</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t937" href="#t937">937</a></span><span class="t">         <span class="nam">project_file</span><span class="op">.</span><span class="nam">file_path</span> <span class="op">==</span> <span class="nam">file_path</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t938" href="#t938">938</a></span><span class="t">        <span class="key">return</span>  <span class="nam">matches</span><span class="op">[</span><span class="num">0</span><span class="op">]</span> <span class="key">if</span> <span class="nam">matches</span> <span class="key">else</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t939" href="#t939">939</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t940" href="#t940">940</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_saved_projectfiles</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">list</span><span class="op">[</span><span class="nam">ProjectFile</span><span class="op">]</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t941" href="#t941">941</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t942" href="#t942">942</a></span><span class="t"><span class="str">        Retrieves the list of saved project files associated with the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t943" href="#t943">943</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t944" href="#t944">944</a></span><span class="t"><span class="str">        This function returns the current state of the saved project files as a list of ProjectFile instances.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t945" href="#t945">945</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t946" href="#t946">946</a></span><span class="t"><span class="str">        :return: A list containing the saved project files.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t947" href="#t947">947</a></span><span class="t"><span class="str">        :rtype: list[ProjectFile]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t948" href="#t948">948</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t949" href="#t949">949</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t950" href="#t950">950</a></span><span class="t">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t951" href="#t951">951</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t952" href="#t952">952</a></span><span class="t">    <span class="key">def</span> <span class="nam">copy_and_add_project_file</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">file_path</span><span class="op">:</span> <span class="nam">Path</span> <span class="op">|</span> <span class="nam">str</span><span class="op">,</span> <span class="nam">state</span><span class="op">:</span> <span class="nam">FileState</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t953" href="#t953">953</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t954" href="#t954">954</a></span><span class="t"><span class="str">        Adds a saved project file to the list of saved project files, makes a copy of it, and</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t955" href="#t955">955</a></span><span class="t"><span class="str">        updates its state.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t956" href="#t956">956</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t957" href="#t957">957</a></span><span class="t"><span class="str">        This function converts the file path to a Path object if it is provided as a string,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t958" href="#t958">958</a></span><span class="t"><span class="str">        constructs the full file path, and appends a new ProjectFile instance to the saved project</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t959" href="#t959">959</a></span><span class="t"><span class="str">        files.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t960" href="#t960">960</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t961" href="#t961">961</a></span><span class="t"><span class="str">        :param file_path: The path of the file to be saved, which can be a string or a Path object.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t962" href="#t962">962</a></span><span class="t"><span class="str">        :type file_path: Path | str</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t963" href="#t963">963</a></span><span class="t"><span class="str">        :param state: The state of the project file to be saved.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t964" href="#t964">964</a></span><span class="t"><span class="str">        :type state: FileState</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t965" href="#t965">965</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t966" href="#t966">966</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t967" href="#t967">967</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t968" href="#t968">968</a></span><span class="t"><span class="str">        :raises ValueError: If the provided file_path is invalid or if the state is not a valid</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t969" href="#t969">969</a></span><span class="t"><span class="str">                            FileState.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t970" href="#t970">970</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t971" href="#t971">971</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t972" href="#t972">972</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t973" href="#t973">973</a></span><span class="t">        <span class="key">if</span> <span class="nam">isinstance</span><span class="op">(</span><span class="nam">file_path</span><span class="op">,</span><span class="nam">str</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t974" href="#t974">974</a></span><span class="t">            <span class="nam">file_path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">file_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t975" href="#t975">975</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t976" href="#t976">976</a></span><span class="t">        <span class="key">if</span> <span class="nam">self</span><span class="op">.</span><span class="nam">has_duplicate_filename</span><span class="op">(</span><span class="nam">filename</span><span class="op">=</span><span class="nam">file_path</span><span class="op">.</span><span class="nam">name</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t977" href="#t977">977</a></span><span class="t">                                       <span class="nam">project_files_list</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t978" href="#t978">978</a></span><span class="t">            <span class="key">return</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t979" href="#t979">979</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t980" href="#t980">980</a></span><span class="t">        <span class="nam">end_location</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">make_copy_of_added_file</span><span class="op">(</span><span class="nam">filepath</span><span class="op">=</span><span class="nam">file_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t981" href="#t981">981</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">ProjectFile</span><span class="op">(</span><span class="nam">file_path</span><span class="op">=</span><span class="nam">end_location</span><span class="op">,</span> <span class="nam">state</span><span class="op">=</span><span class="nam">state</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t982" href="#t982">982</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">save_project_filepaths_to_file</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t983" href="#t983">983</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t984" href="#t984">984</a></span><span class="t">    <span class="key">def</span> <span class="nam">has_duplicate_filename</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">filename</span><span class="op">:</span> <span class="nam">str</span><span class="op">,</span> <span class="nam">project_files_list</span><span class="op">:</span> <span class="nam">list</span><span class="op">[</span><span class="nam">ProjectFile</span><span class="op">]</span><span class="op">)</span> <span class="op">-></span> <span class="nam">bool</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t985" href="#t985">985</a></span><span class="t">        <span class="nam">file_names_in_project</span> <span class="op">=</span> <span class="op">[</span><span class="nam">project_file</span><span class="op">.</span><span class="nam">file_path</span><span class="op">.</span><span class="nam">name</span> <span class="key">for</span> <span class="nam">project_file</span> <span class="key">in</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t986" href="#t986">986</a></span><span class="t">                                 <span class="nam">project_files_list</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t987" href="#t987">987</a></span><span class="t">        <span class="nam">has_duplicate</span> <span class="op">=</span> <span class="key">False</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t988" href="#t988">988</a></span><span class="t">        <span class="key">if</span> <span class="nam">filename</span> <span class="key">in</span> <span class="nam">file_names_in_project</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t989" href="#t989">989</a></span><span class="t">            <span class="nam">message</span> <span class="op">=</span> <span class="nam">GlobalTranslate</span><span class="op">.</span><span class="nam">_</span><span class="op">(</span><span class="str">"Can't insert duplicate filename {0}"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t990" href="#t990">990</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t991" href="#t991">991</a></span><span class="t">            <span class="nam">msgbox</span> <span class="op">=</span> <span class="nam">NotificationWindow</span><span class="op">(</span><span class="nam">message</span><span class="op">=</span><span class="nam">message</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">filename</span><span class="op">)</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis mis2 show_mis"><span class="n"><a id="t992" href="#t992">992</a></span><span class="t">                                        <span class="nam">title</span><span class="op">=</span><span class="nam">GlobalTranslate</span><span class="op">.</span><span class="nam">_</span><span class="op">(</span><span class="str">"Duplicate filename"</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t993" href="#t993">993</a></span><span class="t">            <span class="nam">msgbox</span><span class="op">.</span><span class="nam">exec</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t994" href="#t994">994</a></span><span class="t">            <span class="nam">has_duplicate</span> <span class="op">=</span> <span class="key">True</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t995" href="#t995">995</a></span><span class="t">        <span class="key">return</span> <span class="nam">has_duplicate</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t996" href="#t996">996</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t997" href="#t997">997</a></span><span class="t">    <span class="key">def</span> <span class="nam">make_copy_of_added_file</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">filepath</span><span class="op">:</span> <span class="nam">Path</span><span class="op">)</span> <span class="op">-></span> <span class="nam">Path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t998" href="#t998">998</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t999" href="#t999">999</a></span><span class="t"><span class="str">        Creates a copy of the specified file in the OTL template files directory.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1000" href="#t1000">1000</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1001" href="#t1001">1001</a></span><span class="t"><span class="str">        This function ensures the destination directory exists, copies the file if it is not</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1002" href="#t1002">1002</a></span><span class="t"><span class="str">        already in the target location, and returns the path to the copied file.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1003" href="#t1003">1003</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1004" href="#t1004">1004</a></span><span class="t"><span class="str">        :param filepath: The path of the file to be copied.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1005" href="#t1005">1005</a></span><span class="t"><span class="str">        :type filepath: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1006" href="#t1006">1006</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1007" href="#t1007">1007</a></span><span class="t"><span class="str">        :return: The path to the copied file in the OTL template files directory.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1008" href="#t1008">1008</a></span><span class="t"><span class="str">        :rtype: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1009" href="#t1009">1009</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1010" href="#t1010">1010</a></span><span class="t"><span class="str">        :raises FileNotFoundError: If the specified file does not exist.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1011" href="#t1011">1011</a></span><span class="t"><span class="str">        :raises OSError: If there is an issue creating the directory or copying the file.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1012" href="#t1012">1012</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1013" href="#t1013">1013</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1014" href="#t1014">1014</a></span><span class="t">        <span class="nam">location_dir</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_project_files_dir_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1015" href="#t1015">1015</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">location_dir</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1016" href="#t1016">1016</a></span><span class="t">            <span class="nam">old_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_old_project_files_dir_path</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1017" href="#t1017">1017</a></span><span class="t">            <span class="key">if</span> <span class="nam">old_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1018" href="#t1018">1018</a></span><span class="t">                <span class="nam">location_dir</span> <span class="op">=</span> <span class="nam">old_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1019" href="#t1019">1019</a></span><span class="t">            <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1020" href="#t1020">1020</a></span><span class="t">                <span class="nam">location_dir</span><span class="op">.</span><span class="nam">mkdir</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1021" href="#t1021">1021</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1022" href="#t1022">1022</a></span><span class="t">        <span class="nam">doc_name</span> <span class="op">=</span> <span class="nam">filepath</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1023" href="#t1023">1023</a></span><span class="t">        <span class="nam">end_location</span> <span class="op">=</span> <span class="nam">location_dir</span> <span class="op">/</span> <span class="nam">doc_name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1024" href="#t1024">1024</a></span><span class="t">        <span class="key">if</span> <span class="nam">end_location</span> <span class="op">==</span> <span class="nam">filepath</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1025" href="#t1025">1025</a></span><span class="t">            <span class="key">return</span> <span class="nam">end_location</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1026" href="#t1026">1026</a></span><span class="t">        <span class="nam">shutil</span><span class="op">.</span><span class="nam">copy</span><span class="op">(</span><span class="nam">src</span><span class="op">=</span><span class="nam">filepath</span><span class="op">,</span> <span class="nam">dst</span><span class="op">=</span><span class="nam">end_location</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1027" href="#t1027">1027</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="fst">f"</span><span class="fst">Created a copy of the template file </span><span class="op">{</span><span class="nam">filepath</span><span class="op">.</span><span class="nam">name</span><span class="op">}</span><span class="fst"> in the project folder</span><span class="fst">"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1028" href="#t1028">1028</a></span><span class="t">        <span class="key">return</span> <span class="nam">end_location</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1029" href="#t1029">1029</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1030" href="#t1030">1030</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1031" href="#t1031">1031</a></span><span class="t">    <span class="key">def</span> <span class="nam">remove_all_project_files</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1032" href="#t1032">1032</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1033" href="#t1033">1033</a></span><span class="t"><span class="str">        Removes all project files from memory and deletes them from the file system.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1034" href="#t1034">1034</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1035" href="#t1035">1035</a></span><span class="t"><span class="str">        This function iterates through the list of saved project files, attempts to delete each one, and handles any errors that occur during the deletion process. It creates a notification window to the user if the program doesn't have access to the file, and an empty saved_project_files list is saved to saved_document.json after the whole process.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1036" href="#t1036">1036</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1037" href="#t1037">1037</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1038" href="#t1038">1038</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1039" href="#t1039">1039</a></span><span class="t"><span class="str">        :raises ExcelFileUnavailableError: If a file cannot be deleted due to its unavailability.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1040" href="#t1040">1040</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1041" href="#t1041">1041</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1042" href="#t1042">1042</a></span><span class="t">        <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="str">"memory contains %s"</span><span class="op">,</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1043" href="#t1043">1043</a></span><span class="t">        <span class="key">for</span> <span class="nam">file</span> <span class="key">in</span> <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1044" href="#t1044">1044</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="str">"starting to delete file %s"</span><span class="op">,</span><span class="nam">file</span><span class="op">.</span><span class="nam">file_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1045" href="#t1045">1045</a></span><span class="t">            <span class="key">try</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1046" href="#t1046">1046</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">_delete_project_file</span><span class="op">(</span><span class="nam">file_path</span><span class="op">=</span><span class="nam">file</span><span class="op">.</span><span class="nam">file_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1047" href="#t1047">1047</a></span><span class="t">            <span class="key">except</span> <span class="nam">ExcelFileUnavailableError</span> <span class="key">as</span> <span class="nam">e</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1048" href="#t1048">1048</a></span><span class="t">                <span class="com"># TODO: make a call here to GUI to create this dialogwindow</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1049" href="#t1049">1049</a></span><span class="t">                <span class="nam">global_vars</span><span class="op">.</span><span class="nam">otl_wizard</span><span class="op">.</span><span class="nam">main_window</span><span class="op">.</span><span class="nam">notify_user_of_excel_file_unavailable_error</span><span class="op">(</span><span class="nam">e</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1050" href="#t1050">1050</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1051" href="#t1051">1051</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1052" href="#t1052">1052</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">save_project_filepaths_to_file</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1053" href="#t1053">1053</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1054" href="#t1054">1054</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1055" href="#t1055">1055</a></span><span class="t">    <span class="key">def</span> <span class="nam">remove_project_file</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">file_path</span><span class="op">)</span> <span class="op">-></span> <span class="nam">bool</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1056" href="#t1056">1056</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1057" href="#t1057">1057</a></span><span class="t"><span class="str">        Removes a specified project file from the list of saved project files and deletes it from</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1058" href="#t1058">1058</a></span><span class="t"><span class="str">        the file system if it exists.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1059" href="#t1059">1059</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1060" href="#t1060">1060</a></span><span class="t"><span class="str">        This function checks if the file is part of the project, attempts to delete it, and</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1061" href="#t1061">1061</a></span><span class="t"><span class="str">        updates the saved project files accordingly.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1062" href="#t1062">1062</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1063" href="#t1063">1063</a></span><span class="t"><span class="str">        :param file_path: The path of the project file to be removed.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1064" href="#t1064">1064</a></span><span class="t"><span class="str">        :type file_path: Path | str</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1065" href="#t1065">1065</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1066" href="#t1066">1066</a></span><span class="t"><span class="str">        :return: True if the file was successfully removed, False otherwise.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1067" href="#t1067">1067</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1068" href="#t1068">1068</a></span><span class="t"><span class="str">        :raises ExcelFileUnavailableError: If the file cannot be deleted due to its unavailability.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1069" href="#t1069">1069</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1070" href="#t1070">1070</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1071" href="#t1071">1071</a></span><span class="t">        <span class="nam">project_file</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">is_in_project</span><span class="op">(</span><span class="nam">file_path</span><span class="op">=</span><span class="nam">file_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1072" href="#t1072">1072</a></span><span class="t">        <span class="nam">res</span> <span class="op">=</span> <span class="key">False</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1073" href="#t1073">1073</a></span><span class="t">        <span class="key">if</span> <span class="nam">project_file</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1074" href="#t1074">1074</a></span><span class="t">            <span class="key">if</span> <span class="nam">project_file</span><span class="op">.</span><span class="nam">file_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1075" href="#t1075">1075</a></span><span class="t">                <span class="key">try</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1076" href="#t1076">1076</a></span><span class="t">                    <span class="nam">res</span> <span class="op">=</span>  <span class="nam">self</span><span class="op">.</span><span class="nam">_delete_project_file</span><span class="op">(</span><span class="nam">file_path</span><span class="op">=</span><span class="nam">project_file</span><span class="op">.</span><span class="nam">file_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1077" href="#t1077">1077</a></span><span class="t">                <span class="key">except</span> <span class="nam">ExcelFileUnavailableError</span> <span class="key">as</span> <span class="nam">e</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1078" href="#t1078">1078</a></span><span class="t">                    <span class="com">#TODO: make a call here to GUI to create this dialogwindow</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1079" href="#t1079">1079</a></span><span class="t">                    <span class="nam">global_vars</span><span class="op">.</span><span class="nam">otl_wizard</span><span class="op">.</span><span class="nam">main_window</span><span class="op">.</span><span class="nam">notify_user_of_excel_file_unavailable_error</span><span class="op">(</span><span class="nam">e</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1080" href="#t1080">1080</a></span><span class="t">            <span class="key">else</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1081" href="#t1081">1081</a></span><span class="t">                <span class="nam">res</span> <span class="op">=</span> <span class="key">True</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1082" href="#t1082">1082</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1083" href="#t1083">1083</a></span><span class="t">            <span class="key">if</span> <span class="nam">res</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1084" href="#t1084">1084</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span><span class="op">.</span><span class="nam">remove</span><span class="op">(</span><span class="nam">project_file</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1085" href="#t1085">1085</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">save_project_filepaths_to_file</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1086" href="#t1086">1086</a></span><span class="t">        <span class="key">return</span> <span class="nam">res</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1087" href="#t1087">1087</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1088" href="#t1088">1088</a></span><span class="t">    <span class="op">@</span><span class="nam">staticmethod</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1089" href="#t1089">1089</a></span><span class="t">    <span class="key">def</span> <span class="nam">_delete_project_file</span><span class="op">(</span><span class="nam">file_path</span><span class="op">)</span> <span class="op">-></span> <span class="nam">bool</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1090" href="#t1090">1090</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1091" href="#t1091">1091</a></span><span class="t"><span class="str">        Deletes a specified project file from the file system.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1092" href="#t1092">1092</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1093" href="#t1093">1093</a></span><span class="t"><span class="str">        This function attempts to unlink the file at the given path and handles some errors that may occur during the deletion process. Needs following calls after calling this one: self.saved_project_files.remove(project_file) and self.save_project_filepaths_to_file().</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1094" href="#t1094">1094</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1095" href="#t1095">1095</a></span><span class="t"><span class="str">        :param file_path: The path of the project file to be deleted.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1096" href="#t1096">1096</a></span><span class="t"><span class="str">        :type file_path: Path | str</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1097" href="#t1097">1097</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1098" href="#t1098">1098</a></span><span class="t"><span class="str">        :return: True if the file was successfully deleted, False if the file was not found.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1099" href="#t1099">1099</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1100" href="#t1100">1100</a></span><span class="t"><span class="str">        :raises ExcelFileUnavailableError: If there is a permission error while attempting to delete the file.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1101" href="#t1101">1101</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1102" href="#t1102">1102</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1103" href="#t1103">1103</a></span><span class="t">        <span class="key">try</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1104" href="#t1104">1104</a></span><span class="t">            <span class="nam">file_path_str</span> <span class="op">=</span> <span class="nam">str</span><span class="op">(</span><span class="nam">file_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1105" href="#t1105">1105</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">debug</span><span class="op">(</span><span class="fst">f"</span><span class="fst">file path = </span><span class="op">{</span><span class="nam">file_path_str</span><span class="op">}</span><span class="fst">"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1106" href="#t1106">1106</a></span><span class="t">            <span class="nam">Path</span><span class="op">(</span><span class="nam">file_path</span><span class="op">)</span><span class="op">.</span><span class="nam">unlink</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1107" href="#t1107">1107</a></span><span class="t">            <span class="key">return</span> <span class="key">True</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1108" href="#t1108">1108</a></span><span class="t">        <span class="key">except</span> <span class="nam">FileNotFoundError</span> <span class="key">as</span> <span class="nam">e</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1109" href="#t1109">1109</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">error</span><span class="op">(</span><span class="nam">e</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1110" href="#t1110">1110</a></span><span class="t">            <span class="key">return</span> <span class="key">False</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1111" href="#t1111">1111</a></span><span class="t">        <span class="key">except</span> <span class="nam">PermissionError</span> <span class="key">as</span> <span class="nam">e</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1112" href="#t1112">1112</a></span><span class="t">            <span class="com">#TODO: make other errors + dialog windows for cases with non-excel files if necessary</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1113" href="#t1113">1113</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">error</span><span class="op">(</span><span class="nam">e</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1114" href="#t1114">1114</a></span><span class="t">            <span class="key">raise</span> <span class="nam">ExcelFileUnavailableError</span><span class="op">(</span><span class="nam">file_path</span><span class="op">=</span><span class="nam">file_path</span><span class="op">,</span> <span class="nam">exception</span><span class="op">=</span><span class="nam">e</span><span class="op">)</span> <span class="key">from</span> <span class="nam">e</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1115" href="#t1115">1115</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1116" href="#t1116">1116</a></span><span class="t">    <span class="key">def</span> <span class="nam">change_subset</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">new_path</span><span class="op">:</span> <span class="nam">Path</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1117" href="#t1117">1117</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1118" href="#t1118">1118</a></span><span class="t"><span class="str">        Changes the current subset path for the project and resets related properties.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1119" href="#t1119">1119</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1120" href="#t1120">1120</a></span><span class="t"><span class="str">        This function clears the model builder from memory, updates the subset path, loads a new model builder, and resets the subset operator and OTL version to their initial states.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1121" href="#t1121">1121</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1122" href="#t1122">1122</a></span><span class="t"><span class="str">        :param new_path: The new path to set as the subset for the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1123" href="#t1123">1123</a></span><span class="t"><span class="str">        :type new_path: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1124" href="#t1124">1124</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1125" href="#t1125">1125</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1126" href="#t1126">1126</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1127" href="#t1127">1127</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1128" href="#t1128">1128</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">clear_model_builder_from_memory</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1129" href="#t1129">1129</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span> <span class="op">=</span> <span class="nam">new_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1130" href="#t1130">1130</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">model_builder</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">get_model_builder</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1131" href="#t1131">1131</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">subset_operator</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1132" href="#t1132">1132</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">otl_version</span> <span class="op">=</span> <span class="key">None</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1133" href="#t1133">1133</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">update_last_alter_time</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1134" href="#t1134">1134</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">save_project_to_dir</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1135" href="#t1135">1135</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1136" href="#t1136">1136</a></span><span class="t">    <span class="key">def</span> <span class="nam">update_information</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">new_eigen_ref</span><span class="op">:</span><span class="nam">str</span><span class="op">,</span> <span class="nam">new_bestek</span><span class="op">:</span><span class="nam">str</span><span class="op">,</span> <span class="nam">new_subset_path</span><span class="op">:</span> <span class="nam">Path</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1137" href="#t1137">1137</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1138" href="#t1138">1138</a></span><span class="t"><span class="str">        Updates the project information with new details.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1139" href="#t1139">1139</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1140" href="#t1140">1140</a></span><span class="t"><span class="str">        This method modifies the project's eigen reference,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1141" href="#t1141">1141</a></span><span class="t"><span class="str">        bestek, and subset path, ensuring that the project reflects the latest information.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1142" href="#t1142">1142</a></span><span class="t"><span class="str">        It also updates the last altered time to track when the changes were made.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1143" href="#t1143">1143</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1144" href="#t1144">1144</a></span><span class="t"><span class="str">        :param new_eigen_ref: The new eigen reference for the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1145" href="#t1145">1145</a></span><span class="t"><span class="str">        :type new_eigen_ref: str</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1146" href="#t1146">1146</a></span><span class="t"><span class="str">        :param new_bestek: The new bestek for the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1147" href="#t1147">1147</a></span><span class="t"><span class="str">        :type new_bestek: str</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1148" href="#t1148">1148</a></span><span class="t"><span class="str">        :param new_subset_path: The new path for the project's subset.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1149" href="#t1149">1149</a></span><span class="t"><span class="str">        :type new_subset_path: Path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1150" href="#t1150">1150</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1151" href="#t1151">1151</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1152" href="#t1152">1152</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1153" href="#t1153">1153</a></span><span class="t">        <span class="com"># check if there is a difference avoid unnecessary renaming of folders</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1154" href="#t1154">1154</a></span><span class="t">        <span class="key">if</span> <span class="nam">new_eigen_ref</span> <span class="op">!=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1155" href="#t1155">1155</a></span><span class="t">            <span class="com"># include the new_subset_path so it can be changed to the new folder name if it is the old subset</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1156" href="#t1156">1156</a></span><span class="t">            <span class="nam">new_subset_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">update_eigen_referentie</span><span class="op">(</span><span class="nam">new_eigen_ref</span><span class="op">,</span><span class="nam">new_subset_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1157" href="#t1157">1157</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">bestek</span> <span class="op">=</span> <span class="nam">new_bestek</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1158" href="#t1158">1158</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">change_subset</span><span class="op">(</span><span class="nam">new_subset_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1159" href="#t1159">1159</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">update_last_alter_time</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1160" href="#t1160">1160</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1161" href="#t1161">1161</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1162" href="#t1162">1162</a></span><span class="t">    <span class="key">def</span> <span class="nam">update_eigen_referentie</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span><span class="nam">new_eigen_ref</span><span class="op">:</span><span class="nam">str</span><span class="op">,</span> <span class="nam">new_subset_path</span><span class="op">:</span><span class="nam">Path</span><span class="op">=</span><span class="key">None</span> <span class="op">)</span> <span class="op">-></span> <span class="nam">Path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1163" href="#t1163">1163</a></span><span class="t">        <span class="nam">new_project_path</span> <span class="op">=</span> <span class="nam">Path</span><span class="op">(</span><span class="nam">ProgramFileStructure</span><span class="op">.</span><span class="nam">get_otl_wizard_projects_dir</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="nam">new_eigen_ref</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1164" href="#t1164">1164</a></span><span class="t">        <span class="key">try</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1165" href="#t1165">1165</a></span><span class="t">            <span class="key">if</span> <span class="nam">new_project_path</span><span class="op">.</span><span class="nam">exists</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1166" href="#t1166">1166</a></span><span class="t">                <span class="key">raise</span> <span class="nam">FileExistsError</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1167" href="#t1167">1167</a></span><span class="t">            <span class="nam">shutil</span><span class="op">.</span><span class="nam">move</span><span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">,</span> <span class="nam">new_project_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1168" href="#t1168">1168</a></span><span class="t">        <span class="key">except</span> <span class="nam">FileExistsError</span> <span class="key">as</span> <span class="nam">ex</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1169" href="#t1169">1169</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">error</span><span class="op">(</span><span class="str">"Project dir %s already exists"</span><span class="op">,</span> <span class="nam">new_project_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1170" href="#t1170">1170</a></span><span class="t">            <span class="key">raise</span> <span class="nam">ProjectExistsError</span><span class="op">(</span><span class="nam">eigen_referentie</span><span class="op">=</span><span class="nam">new_eigen_ref</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1171" href="#t1171">1171</a></span><span class="t">        <span class="key">except</span> <span class="nam">PermissionError</span> <span class="key">as</span> <span class="nam">ex</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1172" href="#t1172">1172</a></span><span class="t">            <span class="nam">OTLLogger</span><span class="op">.</span><span class="nam">logger</span><span class="op">.</span><span class="nam">error</span><span class="op">(</span><span class="str">"No permission to rename "</span><span class="op">,</span> <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1173" href="#t1173">1173</a></span><span class="t">            <span class="key">raise</span> <span class="nam">ex</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1174" href="#t1174">1174</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1175" href="#t1175">1175</a></span><span class="t">        <span class="com"># try:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1176" href="#t1176">1176</a></span><span class="t">        <span class="com">#     shutil.copytree(self.project_path, new_project_path)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1177" href="#t1177">1177</a></span><span class="t">        <span class="com"># except FileExistsError as ex:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1178" href="#t1178">1178</a></span><span class="t">        <span class="com">#     OTLLogger.logger.error("Project dir %s already exists", new_project_path)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1179" href="#t1179">1179</a></span><span class="t">        <span class="com">#     raise ProjectExistsError(eigen_referentie=new_eigen_ref)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1180" href="#t1180">1180</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1181" href="#t1181">1181</a></span><span class="t">        <span class="com"># delete the original path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1182" href="#t1182">1182</a></span><span class="t">        <span class="com"># self.delete_project_dir_by_path()</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1183" href="#t1183">1183</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1184" href="#t1184">1184</a></span><span class="t">        <span class="com"># change the new subset path otherwise change the old one</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1185" href="#t1185">1185</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">new_subset_path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1186" href="#t1186">1186</a></span><span class="t">            <span class="nam">new_subset_path</span> <span class="op">=</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1187" href="#t1187">1187</a></span><span class="t">        <span class="key">elif</span> <span class="nam">new_subset_path</span> <span class="op">==</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1188" href="#t1188">1188</a></span><span class="t">            <span class="nam">new_subset_path</span> <span class="op">=</span> <span class="nam">new_project_path</span> <span class="op">/</span> <span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1189" href="#t1189">1189</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1190" href="#t1190">1190</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1191" href="#t1191">1191</a></span><span class="t">        <span class="com"># make sure the current data is correctly renamed before updating the projects attributes</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1192" href="#t1192">1192</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span> <span class="op">=</span> <span class="nam">new_eigen_ref</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1193" href="#t1193">1193</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">project_path</span> <span class="op">=</span> <span class="nam">new_project_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1194" href="#t1194">1194</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1195" href="#t1195">1195</a></span><span class="t">        <span class="key">return</span> <span class="nam">new_subset_path</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1196" href="#t1196">1196</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1197" href="#t1197">1197</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1198" href="#t1198">1198</a></span><span class="t">    <span class="key">def</span> <span class="nam">update_last_alter_time</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1199" href="#t1199">1199</a></span><span class="t">        <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1200" href="#t1200">1200</a></span><span class="t"><span class="str">        Updates the last altered time of the project.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1201" href="#t1201">1201</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1202" href="#t1202">1202</a></span><span class="t"><span class="str">        This method sets the last altered timestamp to the current date and time, allowing for tracking of when the project was last modified.</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1203" href="#t1203">1203</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1204" href="#t1204">1204</a></span><span class="t"><span class="str">        :return: None</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1205" href="#t1205">1205</a></span><span class="t"><span class="str">        """</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1206" href="#t1206">1206</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1207" href="#t1207">1207</a></span><span class="t">        <span class="nam">time_of_alter</span> <span class="op">=</span> <span class="nam">datetime</span><span class="op">.</span><span class="nam">datetime</span><span class="op">.</span><span class="nam">now</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="nam">date</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1208" href="#t1208">1208</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">laatst_bewerkt</span> <span class="op">=</span> <span class="nam">time_of_alter</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1209" href="#t1209">1209</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1210" href="#t1210">1210</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1211" href="#t1211">1211</a></span><span class="t">    <span class="key">def</span> <span class="nam">__eq__</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span> <span class="nam">__value</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1212" href="#t1212">1212</a></span><span class="t">        <span class="key">if</span> <span class="key">not</span> <span class="nam">__value</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1213" href="#t1213">1213</a></span><span class="t">            <span class="key">return</span> <span class="key">False</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1214" href="#t1214">1214</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1215" href="#t1215">1215</a></span><span class="t">        <span class="key">return</span> <span class="op">(</span><span class="nam">self</span><span class="op">.</span><span class="nam">eigen_referentie</span> <span class="op">==</span> <span class="nam">__value</span><span class="op">.</span><span class="nam">eigen_referentie</span> <span class="key">and</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t1216" href="#t1216">1216</a></span><span class="t">                <span class="nam">Helpers</span><span class="op">.</span><span class="nam">equal_paths</span><span class="op">(</span><span class="nam">path1</span><span class="op">=</span><span class="nam">self</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">,</span><span class="nam">path2</span><span class="op">=</span><span class="nam">__value</span><span class="op">.</span><span class="nam">subset_path</span><span class="op">)</span> <span class="key">and</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t1217" href="#t1217">1217</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">subset_operator</span> <span class="op">==</span> <span class="nam">__value</span><span class="op">.</span><span class="nam">subset_operator</span> <span class="key">and</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t1218" href="#t1218">1218</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">otl_version</span> <span class="op">==</span> <span class="nam">__value</span><span class="op">.</span><span class="nam">otl_version</span> <span class="key">and</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t1219" href="#t1219">1219</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">bestek</span> <span class="op">==</span> <span class="nam">__value</span><span class="op">.</span><span class="nam">bestek</span> <span class="key">and</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t1220" href="#t1220">1220</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">laatst_bewerkt</span> <span class="op">==</span> <span class="nam">__value</span><span class="op">.</span><span class="nam">laatst_bewerkt</span> <span class="key">and</span>&nbsp;</span><span class="r"></span></p>
    <p class="run run2"><span class="n"><a id="t1221" href="#t1221">1221</a></span><span class="t">                <span class="nam">self</span><span class="op">.</span><span class="nam">saved_project_files</span> <span class="op">==</span> <span class="nam">__value</span><span class="op">.</span><span class="nam">saved_project_files</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1222" href="#t1222">1222</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1223" href="#t1223">1223</a></span><span class="t">    <span class="key">def</span> <span class="nam">set_saved_graph_status</span><span class="op">(</span><span class="nam">self</span><span class="op">,</span><span class="nam">new_status</span><span class="op">:</span><span class="nam">bool</span><span class="op">)</span> <span class="op">-></span> <span class="key">None</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1224" href="#t1224">1224</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">graph_saved_status</span> <span class="op">=</span> <span class="nam">new_status</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t1225" href="#t1225">1225</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t1226" href="#t1226">1226</a></span><span class="t">    <span class="key">def</span> <span class="nam">get_saved_graph_status</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span> <span class="op">-></span> <span class="nam">bool</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t1227" href="#t1227">1227</a></span><span class="t">        <span class="key">return</span> <span class="nam">self</span><span class="op">.</span><span class="nam">graph_saved_status</span>&nbsp;</span><span class="r"></span></p>
</main>
<footer>
    <div class="content">
        <p>
            <a class="nav" href="z_7abde31eedd1c534_Updater_py.html">&#xab; prev</a> &nbsp; &nbsp;
            <a class="nav" href="index.html">&Hat; index</a> &nbsp; &nbsp;
            <a class="nav" href="z_5d2320982042e5d4_ProjectFile_py.html">&#xbb; next</a>
            &nbsp; &nbsp; &nbsp;
            <a class="nav" href="https://coverage.readthedocs.io/en/7.10.5">coverage.py v7.10.5</a>,
            created at 2025-08-29 09:27 +0000
        </p>
    </div>
</footer>
</body>
</html>
